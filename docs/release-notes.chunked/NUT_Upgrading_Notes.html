<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>3. NUT Upgrading Notes</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="home" href="index.html" title="Network UPS Tools Release Notes" /><link rel="up" href="index.html" title="Network UPS Tools Release Notes" /><link rel="prev" href="NUT_Release_Notes.html" title="2. NUT Release Notes (and other feature details)" /><link rel="next" href="Project_History.html" title="4. Project history" /><meta xmlns="" name="format-detection" content="telephone=no" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="NUT_Release_Notes.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="Project_History.html">Next</a></td></tr></table><hr /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="NUT_Upgrading_Notes"></a>3. NUT Upgrading Notes</h2></div></div></div><p>This file lists changes that affect users who installed older versions
of this software.  When upgrading from an older version, be sure to
check this file to see if you need to make changes to your system.</p><div class="note" style="margin-left: 0; margin-right: 10%;"><h3 class="title">Note</h3><p>For packaging (OS distribution or in-house) it is recommended to
primarily <code class="literal">./configure --with-all</code> and then excise <code class="literal">--without-something</code>
explicitly for items not supported on your platform, so you do not miss
out on new NUT features as they come with new releases. Some may require
that you update your build environment with new third-party dependencies,
so a broken build of a new NUT release would let you know how to act.</p><p>This is a good time to point out that for stricter packaging systems, it may
be beneficial to add <code class="literal">--enable-option-checking=fatal</code> to the <code class="literal">./configure</code>
command line, in order to quickly pick up any other removed option flags.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_8_3_to_2_8_4"></a>3.1. Changes from 2.8.3 to 2.8.4</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
PLANNED: Keep track of any further API clean-up?
</li><li class="listitem">
Introduced handling (possibly rewriting) for man page section "Overviews,
  conventions, and miscellaneous" (commonly number 7), to deliver support
  for <code class="literal">man nut</code> queries (NUT overview manual page also created).
  A new <code class="literal">configure --with-docs-man-dir-as-base</code> option was introduced so that
  directories for man page sections can now be automatically named as either
  "base" number of the section (e.g. <code class="literal">man1</code>) or by full section name (<code class="literal">man1m</code>),
  as different OS distributions have different preferences in this regard.
  As a packager, you may have to update the recipes accordingly (especially
  if your platform rewrites section numbers). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2945" target="_top">#2945</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/2950" target="_top">#2950</a>]
</li><li class="listitem">
Introduced <code class="literal">powervar-cs</code> (Serial) and <code class="literal">powervar-cu</code> (USB) drivers which share
  a <code class="literal">powervar-cx</code> manual page, rendered once, with pages named after the driver
  aliased to it in post-processing. This may impact packaging, depending on its
  technology. Feel free to deliver file copies, symbolic or hard links as seems
  right for your platform. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2988" target="_top">#2988</a>]
</li><li class="listitem">
Option to <code class="literal">configure --enable-docs-man-for-progs-built-only</code> was added,
  to differentiate NUT builds that deliver man pages for only built programs
  (legacy default) or for all of them (as needed for docs sites). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2976" target="_top">#2976</a>]
</li><li class="listitem">
Added APC BVKxxxM2 to list of devices where <code class="literal">lbrb_log_delay_sec=N</code> may be
  necessary to address spurious LOWBATT and REPLACEBATT events. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2942" target="_top">issue #2942</a>]
</li><li class="listitem">
In <code class="literal">nutdrv_qx</code>, updated <code class="literal">megatec</code> protocol subdriver for more detailed
  responses to <code class="literal">I</code> query which may return <code class="literal">ups.serial</code> (after a shorter
  <code class="literal">device.mfr</code>) and the <code class="literal">battery.runtime</code> (after a shorter <code class="literal">device.model</code>).
  Note that the expected response is shorter than in other dialects (38 vs.
  39 bytes), so if this change breaks anything for your UPS that reported
  the values above correctly (e.g. the <code class="literal">ups.firmware</code> version becomes shorter
  or none of these are reported), please let NUT developers know. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2980" target="_top">#2980</a>]
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_8_2_to_2_8_3"></a>3.2. Changes from 2.8.2 to 2.8.3</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
NUT development snapshots can now have more version components than the
  standard semantic versioning triplet, optionally adding the amount of
  commits on the development trunk since previous release, and the amount
  of commits on a feature branch that are unique to it.  Release artifacts
  that have zeroes in both positions would have them stripped and still
  have the standard "semver" exposed, but the development snapshots can
  now be more reasonably upgraded with automated tooling. A copy of the
  current version information would be embedded into "dist" archives as
  a <code class="literal">VERSION_DEFAULT</code> file, so it can be used without git. Certain distros
  can benefit from a <code class="literal">VERSION_FORCED</code> file or a <code class="literal">NUT_VERSION_FORCED</code>
  environment variable exported from their build system, e.g. via
  <code class="literal">echo NUT_VERSION_FORCED=1.1.1 &gt; VERSION_FORCED</code>. Unfortunately, some
  appliances tag all software the same with their firmware version;
  if this is required, a (NUT_)VERSION_FORCED_SEMVER envvar or file can
  help identify the actual NUT release version triplet used on the box.
  Please use it, it immensely helps with community troubleshooting!
  Documentation about this would be maintained in <code class="literal">docs/nut-versioning.adoc</code>
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1949" target="_top">issue #1949</a>]
</li><li class="listitem">
When packaging or custom-building for (Linux) distributions with systemd,
  you can now take advantage of <code class="literal">nut-systemd.preset</code> file to enable or
  disable certain NUT units by default; its comments document each choice.
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2721" target="_top">issue #2721</a>]
</li><li class="listitem">
A <code class="literal">nut-udev-settle.service</code> was introduced to replace dependency on the
  <code class="literal">systemd-udev-settle.service</code> which is deprecated and causes warnings on
  some systems. It was shown to benefit NUT use-cases however. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2638" target="_top">#2638</a>]
</li><li class="listitem">
Reference packages prepared by <code class="literal">make package</code> should now separate the
  <code class="literal">PACKAGE_VERSION</code> from the platform-dependent prefix by a dash character
  in the ultimate package file name. Previously they were glued together
  for some platform targets (HPUX, Solaris). Solaris SVR4 package file names
  should new differentiate <code class="literal">i386</code> vs. <code class="literal">amd64</code> and <code class="literal">sparc</code> vs. <code class="literal">sparcv9</code>,
  depending on <code class="literal">target_cpu</code> of the build. If you had any scripts relying
  on the older pattern, they may have to be updated.
</li><li class="listitem">
The <code class="literal">make dist</code> goal now takes more care to require availability of the
  man pages to put into the prepared distribution archive. Development and CI
  builds on platforms unable to fulfill this goal can use <code class="literal">make distcheck-ci</code>
  (and <code class="literal">make dist-ci</code>) to fake presence of pre-built man pages with placeholder
  files, to complete other aspects of <code class="literal">distcheck</code> validation. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2842" target="_top">#2842</a>]
</li><li class="listitem">
The PyPI distribution of the <code class="literal">PyNUTClient</code> module tarball should now use a
  lower-cased file name (and immediate versioned directory name inside) to
  match the requirements of <a class="ulink" href="https://peps.python.org/pep-0625/" target="_top">PEP-0625</a>.
  The Python module name (and its directory) should remain camel-cased.
  OS distribution package recipes that deliver the module separately (e.g.
  as part of Python ecosystem rather than NUT) may have to adjust. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2773" target="_top">#2773</a>]
</li><li class="listitem">
The NUT-Monitor GUI application localization was updated; <code class="literal">make install</code>
  should now deliver also <code class="literal">xx_YY.UTF-8</code> pattern named symbolic links to the
  short-named directories and files involved, since some platforms insist
  on having those for translations to be found — this should be reflected
  in OS packaging recipes as well. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2845" target="_top">#2845</a>]
</li><li class="listitem"><p class="simpara">
New <code class="literal">libupsclient</code> API methods added:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
<code class="literal">upscli_str_add_unique_token()</code> and <code class="literal">upscli_str_contains_token()</code>,
    to help C NUT clients process <code class="literal">ups.status</code> and similarly structured
    strings same way as NUT core code base. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2852" target="_top">#2852</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/2859" target="_top">#2859</a>]
</li><li class="listitem">
<code class="literal">upscli_set_default_connect_timeout()</code> to modify the internal timeout
    used by <code class="literal">upscli_connect()</code> (default 0 still means blocking connections,
    positive values should time-limit the connection attempts), and
    <code class="literal">upscli_get_default_connect_timeout()</code> to retrieve its copy. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2847" target="_top">#2847</a>]
</li></ul></div></li><li class="listitem">
API versions of <code class="literal">libupsclient</code> and <code class="literal">libnutscan</code> export more symbols now,
  and so were bumped to new "current" numbers; this may impact the naming
  of shared object files to be delivered by updated packaging. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2895" target="_top">#2895</a>]
</li><li class="listitem">
Standard NUT clients including <code class="literal">upsc</code>, <code class="literal">upscmd</code>, <code class="literal">upsrw</code>, <code class="literal">upslog</code>, <code class="literal">upsmon</code>,
  <code class="literal">upsimage</code>, <code class="literal">upsset</code> and <code class="literal">upsstats</code>) were updated to default with a 10-second
  connection establishment timeout in case of name resolution lags or
  unresponsive hosts (notably a problem with <code class="literal">upsmon</code> contacting many remote
  systems at once). This may potentially impact NUT deployments which somehow
  relied on the blocking behavior of these clients; you can use the
  <code class="literal">NUT_DEFAULT_CONNECT_TIMEOUT</code> environment variable to fix this. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2847" target="_top">#2847</a>]
</li><li class="listitem">
Several NUT clients including <code class="literal">upscmd</code>, <code class="literal">upsrw</code>, <code class="literal">upsimage</code>, <code class="literal">upsset</code>,
  <code class="literal">upsstats</code>, and <code class="literal">upslog</code> (during reconnection), did not <code class="literal">UPSCLI_CONN_TRYSSL</code>
  so went plaintext even when secure connections were possible. Fixed to at
  least try being secure, same way as <code class="literal">upsc</code> does for a long time. This may
  cause console or log messages when SSL can not be initialized, you can use
  the <code class="literal">NUT_QUIET_INIT_SSL</code> environment variable to suppress them where the
  cryptography is known to be not set up, so the warnings bring no value. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2847" target="_top">#2847</a>]
</li><li class="listitem">
<code class="literal">lib/*.pc.in</code>: propagate <code class="literal">-R/PATH</code> (or equivalent — as detected by the
  <code class="literal">configure</code> script for the currently used compiler and linker toolkits)
  in <code class="literal">pkg-config</code> metadata pointing to NUT library installation location
  (by default not in system prefix) to help third-party clients link with us
  automatically. If this causes issues, <code class="literal">--disable-ldflags-nut-rpath(-cxx)</code>
  options (or <code class="literal">--enable...="..."</code> with specific linker arguments) can help.
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2782" target="_top">#2782</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/2865" target="_top">#2865</a>]
</li><li class="listitem">
Updated man page generation with <code class="literal">configure</code> script options to specify that
  manual sections on the target platform differ from (Linux-based) defaults
  hard-coded into page sources; this should allow to simplify NUT packaging
  recipe maintenance in distributions (no more updating patches for changed
  or added documentation sources)
</li><li class="listitem">
<code class="literal">upsmon</code> should now integrate natively with systemd-driven OS sleep events
  (built with systemd version 221 or newer "inhibitor interface"), so various
  hacks previously packaged into <code class="literal">/usr/lib/systemd/system-sleep/</code> scripts or
  units requiring/conflicting with the <code class="literal">sleep.target</code> may be obsolete.
  For fallback with older systemd, a <code class="literal">nut-sleep.service</code> is provided now.
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1070" target="_top">#1070</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/2596" target="_top">#2596</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/2597" target="_top">#2597</a>]
</li><li class="listitem">
Added systemd and SMF service integration for <code class="literal">upslog</code> as a <code class="literal">nut-logger</code>
  service (disabled by default, needs a <code class="literal">upslog.conf</code> file to deliver the
  <code class="literal">UPSLOG_ARGS=...</code> setting for actual monitoring and logging). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1803" target="_top">#1803</a>]
</li><li class="listitem">
Handling of per-UPS <code class="literal">ALARM</code> state was introduced to <code class="literal">upsmon</code>, allowing it
  to optionally treat it as a factor in deciding that the device is in a
  "critical" state (polled more often, assumed dead if communications are
  lost). Since it is up to devices and their NUT drivers what they would
  raise as an alarm (might be something as mundane as ECO mode being active),
  some alarms can contribute to unwanted/early shutdowns. For this reason
  a <code class="literal">0|1</code> setting <code class="literal">ALARMCRITICAL</code> was introduced into <code class="literal">upsmon.conf</code> (default
  is <code class="literal">1</code>), for such users to be able to prevent their <code class="literal">upsmon</code> from treating
  the <code class="literal">ALARM</code> status as overly severe when it is not in fact. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2658" target="_top">#2658</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/415" target="_top">#415</a>]
</li><li class="listitem">
<code class="literal">usbhid-ups</code> and <code class="literal">netxml-ups</code> updated to handle "No battery installed!"
  alarm also to set the <code class="literal">RB</code> (Replace Battery) value in <code class="literal">ups.status</code>.
  This may cause dual triggering of notifications (as an <code class="literal">ALARM</code> generally
  and as an important <code class="literal">REPLBATT</code> status in particular) in <code class="literal">upsmon</code>, but
  better safe than sorry. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/415" target="_top">#415</a>]
</li><li class="listitem">
<code class="literal">usbhid-ups</code> subdriver <code class="literal">PowerCOM HID</code> seemingly sent UPS <code class="literal">shutdown</code> and
  <code class="literal">stayoff</code> commands in wrong byte order, at least for devices currently
  in the field. Driver now sends the commands in a way that satisfies new
  devices; just in case a flag toggle <code class="literal">powercom_sdcmd_byte_order_fallback</code>
  was added to set the old behavior (if some devices do need it). [<a class="ulink" href="https://github.com/networkupstools/nut/pull/2480" target="_top">PR #2480</a>]
</li><li class="listitem">
<code class="literal">usbhid-ups</code> subdriver <code class="literal">CyberPower HID</code> default <code class="literal">pollfreq</code> sped up to
  12 seconds (common default is 30 seconds). Feedback is welcome if this
  improves connection stability or overwhelms the UPS controller instead.
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1689" target="_top">issue #1689</a>, <a class="ulink" href="https://github.com/networkupstools/nut/pull/2718" target="_top">PR #2718</a>]
</li><li class="listitem">
<code class="literal">usbhid-ups</code> subdriver <code class="literal">CyberPower HID</code> default <code class="literal">offdelay</code> is set to 60
  and <code class="literal">ondelay</code> to 120 seconds, in accordance with man page suggestions;
  users with custom settings not divisible by 60 will be loudly warned. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1394" target="_top">#1394</a>]
</li><li class="listitem">
<code class="literal">snmp-ups</code> subdriver <code class="literal">netvision-mib</code>: synchronized <code class="literal">netvision_output_info</code>
  with the currently available <code class="literal">SOCOMECUPS-MIB.txt</code>; this can impact some
  other devices using that MIB (negatively, if the older mappings were
  indeed correct for any practical cases, and were not a typo). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2803" target="_top">#2803</a>]
</li><li class="listitem">
<code class="literal">nutdrv_qx</code> fixed <code class="literal">hunnox_protocol()</code> to honour the optional <code class="literal">novendor</code>
  setting for devices that are confused by such query (e.g. DEXP LCD EURO
  1200VA); it may be remotely possible that some other devices could begin
  to misbehave due to this fix — please let us know then. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2839" target="_top">#2839</a>]
</li><li class="listitem">
<code class="literal">mge-utalk</code> driver will no longer set non-standard status values <code class="literal">COMMFAULT</code>
  and <code class="literal">ALARM</code> (for a specific status bit); instead, it will set modern
  <code class="literal">ups.alarm</code> with values <code class="literal">COMMFAULT</code> and/or <code class="literal">DEVICEALARM</code> (and raise
  an <code class="literal">ALARM</code> in <code class="literal">ups.status</code> for either, as standard alarms go). If your
  clients (e.g. custom parsing scripts) for devices supported by this driver
  depended on those non-standard tokens in <code class="literal">ups.status</code>, they would have to
  be updated to handle the new token values in <code class="literal">ups.alarm</code> instead. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2708" target="_top">#2708</a>]
</li><li class="listitem">
Added support for <code class="literal">lbrb_log_delay_sec=N</code> setting to delay propagation of
  <code class="literal">LB</code> or <code class="literal">LB+RB</code> state (buggy with APC BXnnnnMI devices/firmwares issued
  circa 2023-2024 which flood the logs with spurious LOWBATT and REPLACEBATT
  events). This may work better for some devices when combined with flags
  like <code class="literal">onlinedischarge_calibration</code> and <code class="literal">lbrb_log_delay_without_calibrating</code>.
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2347" target="_top">#2347</a>]
</li><li class="listitem">
Enabled installation of built PDF and HTML (including man page renditions)
  files under the configured <code class="literal">docdir</code>. It seems previously they were only
  built (if requested) but not installed via <code class="literal">make</code>, unlike the common man
  pages which are delivered automatically. Packaging recipes can likely
  be simplified now. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2445" target="_top">#2445</a>]
</li><li class="listitem">
A <code class="literal">NUT_DEBUG_SYSLOG</code> environment variable was introduced to tweak activation
  of syslog message emission (and related detachment of <code class="literal">stderr</code> when daemons
  are backgrounding), which can be useful for systemd service units. It can be
  set via <code class="literal">nut.conf</code> file for all standard consumers, or patched/dropped-in to
  systemd unit definitions specifically (less recommended, but may be easier
  to package). The positive effect would be avoiding duplicate logging as both
  <code class="literal">syslog</code> and <code class="literal">stderr</code> ending up in the same journal. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2394" target="_top">#2394</a>]
</li><li class="listitem">
A <code class="literal">CHANGELOG_REQUIRE_GROUP_BY_DATE_AUTHOR</code> setting was added (for <code class="literal">make</code>
  calls and used by <code class="literal">tools/gitlog2changelog.py.in</code> script), and it defaults
  to <code class="literal">true</code> allowing for better ordered documents at the cost of some memory
  during document generation. Resource-constrained builders (working from
  a Git workspace, not tarball archives) may have to set it to <code class="literal">false</code> when
  calling <code class="literal">make</code> for NUT. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2510" target="_top">#2510</a>]
</li><li class="listitem">
Drivers should now be able to set <code class="literal">STATEPATH</code> via <code class="literal">ups.conf</code> to match <code class="literal">upsd</code>
  custom configuration ability; in fact, the data server would prefer the
  value from <code class="literal">ups.conf</code> over the one in <code class="literal">upsd.conf</code>, if both are present.
  Note that <code class="literal">NUT_STATEPATH</code> environment variable trumps both. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/694" target="_top">issue #694</a>]
</li><li class="listitem">
NUT products like <code class="literal">nut-scanner</code>, which dynamically load shared libraries
  at run-time without persistent pre-linking, should now know the library
  file names that were present during build (likely encumbered with version
  suffixes), and prefer them over plain <code class="literal">libname.so</code> patterns used previously
  (which on some platforms are only delivered by development packages as
  symlinks). Packaging recipes can likely be simplified now: some distros
  certainly did patch NUT source to similar effect). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2431" target="_top">#2431</a>]
</li><li class="listitem">
Numerous changes to <code class="literal">nut-scanner</code> and symbols that its <code class="literal">libnutscan.so</code>
  delivers have caused a library version bump.  New methods have been added
  and one structure (<code class="literal">nutscan_ipmi_t</code>) updated in a (hopefully) backwards
  compatible manner. [<a class="ulink" href="https://github.com/networkupstools/nut/pull/2523" target="_top">PR #2523</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/2244" target="_top">issue #2244</a> and numerous PRs for it]
</li><li class="listitem">
The <code class="literal">nutconf</code> tool added to main codebase with NUT v2.8.2 release could be
  packaged as a single program (with just a dependency on <code class="literal">libnutscan</code>), e.g.
  the library code with configuration file processing logic was built into it.
  Starting with NUT v2.8.3, the <code class="literal">libnutconf</code> may optionally be built as a
  standalone shared library, to deliver for development of integrations using
  <code class="literal">--with-dev-libnutconf</code> option. In this case the <code class="literal">nutconf</code> tool program would
  also depend on it for run-time linking. This may have to be considered in
  packaging recipes. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2828" target="_top">#2828</a>]
</li><li class="listitem">
Internal API change for <code class="literal">sendsignalpid()</code> and <code class="literal">sendsignalfn()</code> methods,
  which can impact NUT forks which build using <code class="literal">libcommon.la</code> and similar
  libraries.  Added new last argument with <code class="literal">const char *progname</code> (may be
  <code class="literal">NULL</code>) to check that we are signalling an expected program name when we
  work with a PID.  With the same effort, NUT programs which deal with PID
  files to send signals (<code class="literal">upsd</code>, <code class="literal">upsmon</code>, drivers and <code class="literal">upsdrvctl</code>) would
  now default to a safety precaution — checking that the running process
  with that PID has the expected program name (on platforms where we can
  determine one). This might introduce regressions for heavily customized
  NUT builds (e.g. embedded in NAS or similar devices) whose binary file
  names differ significantly from a <code class="literal">progname</code> defined in the respective
  NUT source file, so a boolean <code class="literal">NUT_IGNORE_CHECKPROCNAME</code> environment
  variable support was added to optionally disable this verification.
  Also the NUT daemons should request to double-check against their
  run-time process name (if it can be detected). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2463" target="_top">issue #2463</a>]
</li><li class="listitem"><p class="simpara">
More environment variable support was added to NUT programs, primarily
  aimed at wrappers such as init scripts and service unit definitions,
  allowing to tweak what (and whether) they write into debug traces, and
  so "make noise" or "bring invaluable insights" to logs or terminal;
  they can generally be used for services and init scripts via <code class="literal">nut.conf</code>:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
See <code class="literal">NUT_IGNORE_CHECKPROCNAME</code> and <code class="literal">NUT_DEBUG_SYSLOG</code> above. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1915" target="_top">#1915</a>]
</li><li class="listitem">
See <code class="literal">NUT_DEFAULT_CONNECT_TIMEOUT</code> above. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2847" target="_top">#2847</a>]
</li><li class="listitem">
A <code class="literal">NUT_QUIET_INIT_BANNER</code> envvar (presence or "true" value) prevents
    tool name and NUT version banner from being printed out when programs
    start. [issues <a class="ulink" href="https://github.com/networkupstools/nut/issues/1789" target="_top">#1789</a> vs. <a class="ulink" href="https://github.com/networkupstools/nut/issues/316" target="_top">#316</a>]
</li></ul></div></li><li class="listitem">
A <code class="literal">configure</code> script option to build <code class="literal">--with-modbus+usb</code> was added to
  let the caller insist on the use of USB-capable libmodbus (or fail the
  NUT build attempt). Certain build arguments can default this option to
  become enabled (implicitly): <code class="literal">configure --with-modbus --with-usb</code> and
  either <code class="literal">--with-drivers=*apc_modbus*</code> (actually implies <code class="literal">--with-modbus</code>)
  or <code class="literal">--with-modbus-includes=... --with-modbus-libs=...</code>
  as a way to avoid surprises with custom NUT builds aiming to have an
  USB-capable <code class="literal">apc_modbus</code> driver (currently this requires a custom-built
  libmodbus, can be a static build to avoid conflicts with OS). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2666" target="_top">#2666</a>]
</li><li class="listitem">
A <code class="literal">configure</code> script option to <code class="literal">--enable-NUT_STRARG-always</code> was added
  to enable the <code class="literal">NUT_STRARG</code> macro (to handle <code class="literal">NULL</code> string printing)
  even if system libraries seem to safely support this behavior natively.
  This should primarily help against overly zealous static analysis tools
  in recent compiler generations. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2585" target="_top">#2585</a>]
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_8_1_to_2_8_2"></a>3.3. Changes from 2.8.1 to 2.8.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Builds requested with a specific C/C<code class="literal"> language standard revision via
  <code class="literal">CFLAGS</code> and <code class="literal">CXXFLAGS</code> should again be honoured. There was a mishap
  with the <code class="literal">m4</code> scripting for <code class="literal">autoconf</code> which could have caused use of
  C11/C</code>11 if compiler supported it, regardless of a request. [<a class="ulink" href="https://github.com/networkupstools/nut/pull/2306" target="_top">PR #2306</a>]
</li><li class="listitem">
Added generation of FreeBSD/pfSense quirks for USB devices supported
  by NUT (may get installed to <code class="literal">$datadir</code> e.g. <code class="literal">/usr/local/share/nut</code>
  and need to be pasted into your <code class="literal">/boot/loader.conf.local</code>). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2159" target="_top">#2159</a>]
</li><li class="listitem">
nut-scanner now does not propose active <code class="literal">bus</code>, <code class="literal">busport</code> and <code class="literal">device</code>
  values when generating device configurations by default. They may
  appear as comments, or enabled by specifying the <code class="literal">-U</code> command-line
  option several times. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2221" target="_top">#2221</a>]
</li><li class="listitem">
The <code class="literal">tools/gitlog2changelog.py.in</code> script was revised, in particular to
  convert section titles (with contributor names) into plain ASCII character
  set, for <code class="literal">dblatex</code> versions which do not allow diacritics and other kinds
  of non-trivial characters in sections. A number of other projects seem to
  use the NUT version of the script, and are encouraged to look at related
  changes in <code class="literal">configure.ac</code> and <code class="literal">Makefile.am</code> recipes. [<a class="ulink" href="https://github.com/networkupstools/nut/pull/2360" target="_top">PR #2360</a>, <a class="ulink" href="https://github.com/networkupstools/nut/pull/2366" target="_top">PR #2366</a>]
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_8_0_to_2_8_1"></a>3.4. Changes from 2.8.0 to 2.8.1</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
NUT documentation recipes were revised, so many of the text source files
  were renamed to <code class="literal">*.adoc</code> pattern. Newly, a <code class="literal">release-notes.pdf</code> and HTML
  equivalents are generated. Packages which deliver documentation may need
  to update the lists of files to ship. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1953" target="_top">#1953</a>] Developers may be impacted
  by new <code class="literal">configure --enable-spellcheck</code> toggle (should add spelling checks
  to <code class="literal">make check</code> by default, if tools are available) to facilitate quicker
  acceptance of contributions. Packaging systems may now want to explicitly
  disable it, if it blocks package building (pull requests to update the
  <code class="literal">docs/nut.dict</code> are a better and welcome solution). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2067" target="_top">#2067</a>]
</li><li class="listitem"><p class="simpara">
Several improvements regarding simultaneous support of USB devices that
  were previously deemed "identical" and so NUT driver instances did not
  start for all of them:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
Some more drivers should now use the common USB device matching logic
    and the 7 <code class="literal">ups.conf</code> options for that [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1763" target="_top">#1763</a>], and man pages were
    updated to reflect that [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1766" target="_top">#1766</a>];
</li><li class="listitem">
The <code class="literal">nut-scanner</code> tool should suggest these options in its generated
    device configuration [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1790" target="_top">#1790</a>]: hopefully these would now suffice for
    sufficiently unique combinations;
</li><li class="listitem">
The <code class="literal">nut-scanner</code> tool should also suggest sanity-check violations
    as comments in its generated device configuration [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1810" target="_top">#1810</a>], e.g. bogus
    or duplicate serial number values;
</li><li class="listitem">
The common USB matching logic was updated with an <code class="literal">allow_duplicates</code>
    flag (caveat emptor!) which may help monitor several related no-name
    devices on systems that do not discern "bus" and "device" values
    (although without knowing reliably which one is which… sometimes it
    is better than nothing) [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1756" target="_top">#1756</a>].
</li></ul></div></li><li class="listitem">
Work on NUT for Windows branch led to situation-specific definitions of
  what in POSIX code was all "file descriptors" (an <code class="literal">int</code> type). Now such
  entities are named <code class="literal">TYPE_FD</code>, <code class="literal">TYPE_FD_SER</code> or <code class="literal">TYPE_FD_SOCK</code> with some
  helper macros to name and determine "invalid" values (closed file, etc.)
  Some of these changes happened in NUT header files, and at this time it
  was not investigated whether the set of files delivered for third-party
  code integration (e.g. C/C++ projects binding with <code class="literal">libnutclient</code> or
  `libupsclient) is consistent or requires additional definitions/files.
  If something gets broken by this, it is a bug to address in future [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1556" target="_top">#1556</a>]
</li><li class="listitem"><p class="simpara">
Further revision of public headers delivered by NUT was done, particularly
  to address lack of common data types (<code class="literal">size_t</code>, <code class="literal">ssize_t</code>, <code class="literal">uint16_t</code>,
  <code class="literal">time_t</code> etc.) in third-party client code that earlier sufficed to only
  include NUT headers. Sort of regression by NUT 2.8.0 (note those consumers
  still have to re-declare some numeric variable types used) [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1638" target="_top">#1638</a>]
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
For practical example of NUT consumer adaptation (to cater to both old and
    new API types) please see <a class="ulink" href="https://github.com/collectd/collectd/pull/4043" target="_top">https://github.com/collectd/collectd/pull/4043</a>
</li></ul></div></li><li class="listitem">
Added support for <code class="literal">make install</code> of PyNUT module and NUT-Monitor desktop
  application — such activity was earlier done by packages directly; now
  the packaging recipes may use NUT source-code facilities and package just
  symlinks as relevant for each distro separately [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1462" target="_top">#1462</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/1504" target="_top">#1504</a>]
</li><li class="listitem">
The <code class="literal">upsd.conf</code> listing of <code class="literal">LISTEN</code> addresses was previously inverted
  (the last listed address was applied first), which was counter-intuitive
  and fixed for this release. If user configurations somehow relied on this
  order (e.g. to prioritize IPv6 vs. IPv4 listeners), configuration changes
  may be needed. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2012" target="_top">#2012</a>]
</li><li class="listitem">
The <code class="literal">upsd</code> configured to listen on IPv6 addresses should handle only
  IPv6 (and not IPv4-mappings like it might have done before) to avoid
  surprises and insecurity — if user configurations somehow relied on
  this dual support, configuration changes may be needed to specify both
  desired IP addresses. Note that the daemon logs will now warn if a
  host name resolves to several addresses (and will only listen on the
  first hit, as it did before in such cases). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2012" target="_top">#2012</a>]
</li><li class="listitem">
A definitive behavior for <code class="literal">LISTEN *</code> directives became specified, to try
  handling both IPv4 and IPv6 "any" address (subject to <code class="literal">upsd</code> CLI options
  to only choose one, and to OS abilities). This use-case may be practically
  implemented as a single IPv6 socket on systems with enabled and required
  IPv4-mapped IPv6 address support, or as two separate listening sockets -
  logged messages to this effect (e.g. inability to listen on IPv4 after
  opening IPv6) are expected on some platforms. End-users may also want to
  reconfigure their <code class="literal">upsd.conf</code> files to remove some now-redundant <code class="literal">LISTEN</code>
  lines. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2012" target="_top">#2012</a>]
</li><li class="listitem">
Added support for <code class="literal">make sockdebug</code> for easier developer access to the tool;
  also if <code class="literal">configure --with-dev</code> is in effect, it would now be installed to
  the configured <code class="literal">libexec</code> location. A man page was also added. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1936" target="_top">#1936</a>]
</li><li class="listitem">
NUT software-only drivers (dummy-ups, clone, clone-outlet) separated from
  serial drivers in respective Makefile and configure script options - this
  may impact packaging decisions on some distributions going forward [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1446" target="_top">#1446</a>]
</li><li class="listitem">
GPIO category of drivers was added (<code class="literal">--with-gpio</code> configure script option) -
  this may impact packaging decisions on some (currently Linux released 2018+)
  distributions going forward [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1855" target="_top">#1855</a>]
</li><li class="listitem">
An explicit <code class="literal">configure --with-nut-scanner</code> toggle was added, specifically
  so that build environments requesting <code class="literal">--with-all</code> but lacking <code class="literal">libltdl</code>
  would abort and require the packager either to install the dependency
  or explicitly forfeit building the tool (some distro packages missed it
  quietly in the past) [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1560" target="_top">#1560</a>]
</li><li class="listitem">
An <code class="literal">upsdebugx_report_search_paths()</code> method in NUT common code was added,
  and exposed in <code class="literal">libnutscan.so</code> builds in particular - API version for the
  public library was bumped [<a class="ulink" href="https://github.com/networkupstools/nut/issues/317" target="_top">#317</a>]
</li><li class="listitem"><p class="simpara">
Some environment variable support was added to NUT programs, primarily
  aimed at wrappers such as init scripts and service unit definitions,
  allowing to tweak what (and whether) they write into debug traces, and
  so "make noise" or "bring invaluable insights" to logs or terminal:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
A <code class="literal">NUT_DEBUG_LEVEL=NUM</code> envvar allows to temporarily boost debugging
    of many daemons (<code class="literal">upsd</code>, <code class="literal">upsmon</code>, drivers, <code class="literal">upsdrvctl</code>, <code class="literal">upssched</code>)
    without changes to configuration files or scripted command lines. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1915" target="_top">#1915</a>]
</li><li class="listitem">
A <code class="literal">NUT_DEBUG_PID</code> envvar (presence) support was added to add current
    process ID to tags with debug-level identifiers. This may be useful
    when many NUT daemons write to the same console or log file, such as
    in containers/plugins for Home Assistant, storage appliances, etc. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2118" target="_top">#2118</a>]
</li><li class="listitem">
A <code class="literal">NUT_QUIET_INIT_SSL</code> envvar (presence or "true" value) prevents
    <code class="literal">libupsclient</code> consumers (notoriously <code class="literal">upsc</code>) from reporting whether
    they have initialized SSL support. [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1662" target="_top">#1662</a>]
</li><li class="listitem">
A <code class="literal">NUT_QUIET_INIT_UPSNOTIFY</code> envvar (presence or "true" value)
    prevents daemons which can notify service management frameworks (such
    as systemd) about passing their lifecycle milestones, to not report
    loudly if they could not do so (e.g. running on a system without a
    framework, or misconfigured so they could not report and the OS would
    restart the false-positively "unresponsive" service). [<a class="ulink" href="https://github.com/networkupstools/nut/issues/2136" target="_top">#2136</a>]
</li></ul></div></li><li class="listitem">
<code class="literal">configure</code> script, reference init-script and packaging templates updated
  to eradicate <code class="literal">@PIDPATH@/nut</code> ambiguity in favor of <code class="literal">@ALTPIDPATH@</code> for the
  unprivileged processes vs. <code class="literal">@PIDPATH@</code> for those running as root [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1719" target="_top">#1719</a>]
</li><li class="listitem">
The "layman report" of NUT configuration options displayed after the run
  of <code class="literal">configure</code> script can now be retained and installed by using the
  <code class="literal">--enable-keep_nut_report_feature</code> option; packagers are welcome to make
  use of this, to better keep track of their deliveries [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1826" target="_top">#1826</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/1708" target="_top">#1708</a>]
</li><li class="listitem"><p class="simpara">
Renamed generated nut-common.tmpfiles(.in) ⇒ nut-common-tmpfiles.conf(.in)
  to install a /usr/lib/systemd-tmpfiles/*.conf pattern [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1755" target="_top">#1755</a>]
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
If earlier NUT v2.8.0 package recipes for your Linux distribution dealt
    with this file, you may have to adjust its name for newer releases.
</li><li class="listitem">
Several other issues have been fixed related to this file and its content,
    including <a class="ulink" href="https://github.com/networkupstools/nut/issues/1030" target="_top">#1030</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/1037" target="_top">#1037</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/1117" target="_top">#1117</a> and <a class="ulink" href="https://github.com/networkupstools/nut/issues/1712" target="_top">#1712</a>
</li></ul></div></li><li class="listitem">
Extended Linux systemd support with optional notifications about daemon
  state (READY, RELOADING, STOPPING) and watchdog keep-alive messages.
  Note that <code class="literal">WatchdogSec=</code> values are currently NOT pre-set into systemd
  unit file templates provided by NUT, this is an exercise for end-users
  based on sizing of their deployments and performance of monitoring station
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1590" target="_top">#1590</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/1777" target="_top">#1777</a>]
</li><li class="listitem">
snmp-ups: some subdrivers (addressed using the driver parameter <code class="literal">mibs</code>)
  were renamed: <code class="literal">pw</code> is now <code class="literal">eaton_pw_nm2</code>, and <code class="literal">pxgx_ups</code> is <code class="literal">eaton_pxg_ups</code>
  [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1715" target="_top">#1715</a>]
</li><li class="listitem">
The <code class="literal">tools/gitlog2changelog.py.in</code> script was revised, in particular to
  generate the <code class="literal">ChangeLog</code> file more consistently with different versions
  of Python interpreter, and without breaking the long file paths in the
  resulting mark-up text. Due to this, a copy of this file distributed with
  NUT release archives is expected to considerably differ on first glance
  from its earlier released versions (not just adding lines for the new
  release, but changing lines in the older releases too) [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1945" target="_top">#1945</a>, <a class="ulink" href="https://github.com/networkupstools/nut/issues/1955" target="_top">#1955</a>]
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_7_4_to_2_8_0"></a>3.5. Changes from 2.7.4 to 2.8.0</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
Note to distribution packagers: this version hopefully learns from many
  past mistakes, so many custom patches may be no longer needed. If some
  remain, please consider making pull requests for upstream NUT codebase
  to share the fixes consistently across the ecosystem. Also note that
  some new types of drivers (so package groups with unique dependencies)
  could have appeared since your packaging was written (e.g. with modbus),
  as well as new features in systemd integration (<code class="literal">nut-driver@instances</code>
  and the <code class="literal">nut-driver-enumerator</code> to manage their population), as well as
  updated Python 2 and Python 3 support (again, maybe dictating different
  package groups) as detailed below.
</li><li class="listitem">
Due to changes needed to resolve build warnings, mostly about mismatching
  data types for some variables, some structure definitions and API signatures
  of several routines had to be changed for argument types, return types,
  or both. Primarily this change concerns internal implementation details
  (may impact update of NUT forks with custom drivers using those), but a
  few changes also happened in header files installed for builds configured
  <code class="literal">--with-dev</code> and so may impact <code class="literal">upsclient</code> and <code class="literal">nutclient</code> (C++) consumers.
  At the very least, binaries for those consumers should be rebuilt to remain
  stable with NUT 2.8.0 and not mismatch int-type sizes and other arguments.
</li><li class="listitem">
libusb-1.0: NUT now defaults to building against libusb-1.0 API version
  if the configure script finds the development headers, falling back to
  libusb-0.1 if not. Please report any regressions.
</li><li class="listitem">
apcupsd-ups: When monitoring a remote apcupsd server, interpret "SHUTTING
  DOWN" as a NUT "LB" status. If you were relying on the previous behavior
  (for instance, in a monitor-only situation), please adjust your upsmon
  settings. Reference: <a class="ulink" href="https://github.com/networkupstools/nut/issues/460" target="_top">https://github.com/networkupstools/nut/issues/460</a>
</li><li class="listitem">
Packagers: the AsciiDoc detection has been reworked to allow NUT to be built
  from source without requiring asciidoc/a2x (using pre-built man pages from
  the distribution tarball, for instance). Please double-check that we did not
  break anything (see docs/configure.txt for options).
</li><li class="listitem">
Driver core: options added for standalone mode (scanning for devices without
  requiring ups.conf) - see docs/man/nutupsdrv.txt for details.
</li><li class="listitem">
oldmge-shut has been removed, and replaced by mge-shut.
</li><li class="listitem">
New drivers for devices with "Qx" (also known as "Megatec Q*") family of
  protocols should be developed as sub-drivers in the <code class="literal">nutdrv_qx</code> framework
  for USB and Serial connected devices, not as updates/clones of older e.g.
  <code class="literal">blazer</code> family and <code class="literal">bestups</code>. Sources, man pages and start-up messages
  of such older drivers were marked with "OBSOLETION WARNING".
</li><li class="listitem">
liebert-esp2: some multi-phase variable names have been updated to match the
  rest of NUT.
</li><li class="listitem">
netxml-ups: if you have old firmware, or were relying on values being off by
  a factor of 10, consider the <code class="literal">do_convert_deci</code> flag. See
  docs/man/netxml-ups.txt for details.
</li><li class="listitem">
snmp-ups: detection of Net-SNMP has been updated to use <code class="literal">pkg-config</code> by
  default (if present), rather than <code class="literal">net-snmp-config(-32|-64)</code> script(s) as
  the only option available previously. The scripts tend to specify a lot
  of options (sometimes platform-specific) in suggested <code class="literal">CFLAGS</code> and <code class="literal">LIBS</code>
  compared to the packaged <code class="literal">pkg-config</code> information which also works and is
  more portable. If this change bites your distribution, please bring it up
  in <a class="ulink" href="https://github.com/networkupstools/nut/issues" target="_top">https://github.com/networkupstools/nut/issues</a> or better yet, post a PR.
  Also note that <code class="literal">./configure --with-netsnmp-config(=yes)</code> should set up the
  preference of the detected script over <code class="literal">pkg-config</code> information, if both
  are available, and <code class="literal">--with-netsnmp-config=/path/name</code> would as well.
</li><li class="listitem">
snmp-ups: bit mask values for flags in earlier codebase were defined in a
  way that caused logically different items to have same numeric values.
  This was fixed to surely use different definitions (so changing numbers
  behind some of those macro symbols), and testing with UPS, ePDU and ATS
  hardware which was available did not expose any practical differences.
</li><li class="listitem">
usbhid-ups: numeric data conversion from wire protocol to CPU representation
  in GetValue() was completely reworked, aiming to be correct on all CPU types.
  That said, regressions are possible and feedback is welcome.
</li><li class="listitem">
nut-scanner: Packagers, take note of the changes to the library
  search code in common/common.c. Please file an issue if this does not work
  with your platform.
</li><li class="listitem"><p class="simpara">
dummy-ups can now specify <code class="literal">mode</code> as a driver argument, and separates the
  notion of <code class="literal">dummy-once</code> (new default for <code class="literal">\*.dev</code> files that do not change)
  vs. <code class="literal">dummy-loop</code> (legacy default for <code class="literal">*.seq</code> and others) [<a class="ulink" href="https://github.com/networkupstools/nut/issues/1385" target="_top">issue #1385</a>]
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
Note this can break third-party test scripts which expected <code class="literal">*.dev</code>
    files to work as a looping sequence with a <code class="literal">TIMER</code> keywords to change
    values slowly; now such files should get processed to the end once.
    Specify <code class="literal">mode=dummy-loop</code> driver option or rename the data file used
    in the <code class="literal">port</code> option for legacy behavior.
    Use/Test-cases which modified such files content externally should
    not be impacted.
</li></ul></div></li><li class="listitem"><p class="simpara">
Python: scripts have been updated to work with Python 3 as well as 2.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
PyNUT module (protocol binding) supports both Python generations.
</li><li class="listitem">
NUT-Monitor (desktop UI client) got separated into two projects:
    one with support for Python2 and GTK2, and another for Python3 and Qt5.
    On operating systems that serve both environments, either of these
    implementation should be usable. For distributions that deprecated
    and removed Python2 support, it is a point to consider in NUT packages
    and their build-time and installation dependencies.
    The historic filenames for desktop integration (<code class="literal">NUT-Monitor</code> script
    and <code class="literal">nut-monitor.desktop</code>) are still delivered, but now cover a wrapper
    script which detects the environment capabilities and launches the best
    suitable UI implementation (if both are available).
</li></ul></div></li><li class="listitem">
apcsmart: updates to CS "hack" (see docs/man/apcsmart.txt for details)
</li><li class="listitem">
upsdebugx(): added <code class="literal">[D#]</code> prefix to log entries with level &gt; 0
  so if any scripts or other tools relied on parsing those messages
  making some assumptions, they should be updated
</li><li class="listitem">
upsdebugx() and related methods are now macros, optionally calling similarly
  named implementations like s_upsdebugx() as a slight optimization; this may
  show up in linking of binaries for some customized build scenarios
</li><li class="listitem">
libraries, tools and protocol now support a <code class="literal">TRACKING</code> ID to be used with
  an <code class="literal">INSTCMD</code> or <code class="literal">SET VAR</code> requests; for details see docs/net-protocol.txt
  and docs/sock-protocol.txt
</li><li class="listitem">
upsrw: display the variable type beside ENUM / RANGE
</li><li class="listitem">
Augeas: new <code class="literal">--with-augeas-lenses-dir</code> configure option.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_7_3_to_2_7_4"></a>3.6. Changes from 2.7.3 to 2.7.4</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
scripts/systemd/nut-server.service.in: Restore systemd relationship since it
  was preventing upsd from starting whenever one or more drivers, among several,
  was failing to start
</li><li class="listitem">
Fix UPower device matching for recent kernels, since hiddev* devices now have
  class "usbmisc", rather than "usb"
</li><li class="listitem">
macosx-ups: the "port" driver option no longer has any effect
</li><li class="listitem">
Network protocol information: default to type NUMBER for variables that are
  not flagged as STRING . This point is subject to improvements or change in
  the next release 2.7.5.  Refer to docs/net-protocol.txt for more information
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_7_2_to_2_7_3"></a>3.7. Changes from 2.7.2 to 2.7.3</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The <a class="ulink" href="../man/nutdrv_qx.html" target="_top">nutdrv_qx(8)</a> driver will eventually supersede <a class="ulink" href="../man/bestups.html" target="_top">bestups(8)</a>.
  It has been tested on a U-series Patriot Pro II. Please test the new driver
  on your hardware during your next maintenance window, and report any bugs.
</li><li class="listitem">
If you are upgrading from a new install of 2.7.1 or 2.7.2, double-check the
  value of POWERDOWNFLAG in $prefix/etc/upsmon.conf - it has been restored to
  /etc/killpower as in 2.6.5 and earlier.
</li><li class="listitem">
If you use upslog with a large sleep value, you may be interested in adding
  <code class="literal">killall -SIGUSR1 upslog</code> to any OB/OL script actions. This will force
  upslog to write a log entry to catch short power transients.
</li><li class="listitem">
Be sure that your SSL keys are readable by the NUT system user. The SSL
  subsystem is now initialized after <code class="literal">upsd</code> forks, to work around issues in the
  NSS library.
</li><li class="listitem">
The systemd nut-server.service does not Require nut-driver to be started
  successfully.  This was previously preventing upsd startup, even for just
  one driver failure among many.  This also matches the behavior of sysV
  initscripts.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_7_1_to_2_7_2"></a>3.8. Changes from 2.7.1 to 2.7.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
upsdrvctl is now installed to $prefix/sbin rather than $driverexec.
  This usually means moving from /bin to /sbin, apart from few exceptions.
  In all cases, please adapt your scripts.
</li><li class="listitem">
FreeDesktop Hardware Abstraction Layer (HAL) support was removed.
  Please adapt your packaging files, if you used to distribute the
  nut-hal-drivers package.
</li><li class="listitem">
This is a good time to point out that for stricter packaging systems, it may
  be beneficial to add "--enable-option-checking=fatal" to the ./configure
  command line, in order to quickly pick up any other removed option flags.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_6_5_to_2_7_1"></a>3.9. Changes from 2.6.5 to 2.7.1</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The <a class="ulink" href="../man/apcsmart.html" target="_top">apcsmart(8)</a> driver has been replaced by a new implementation. There is a new
  parameter, <span class="emphasis"><em>ttymode</em></span>, which may help if you have a non-standard serial port,
  or Windows.  In case of issues with this new version, users can revert to
  apcsmart-old.
</li><li class="listitem">
The <a class="ulink" href="../man/nutdrv_qx.html" target="_top">nutdrv_qx(8)</a> driver will eventually supersede blazer_ser and blazer_usb.
  Options are not exactly the same, but are documented in the nutdrv_qx man
  page.
</li><li class="listitem">
Mozilla NSS support has been added. The OpenSSL configuration options should
  be unchanged, but please refer to the <a class="ulink" href="../man/upsd.conf.html" target="_top">upsd.conf(5)</a> and
  <a class="ulink" href="../man/upsmon.conf.html" target="_top">upsmon.conf(5)</a> documentation in case we missed something.
</li><li class="listitem">
<a class="ulink" href="../man/upsrw.html" target="_top">upsrw(8)</a> now prints out the maximum size of variables. Hopefully you
  are not parsing the output of upsrw - it would be easier to use one of the
  NUT libraries, or implement the network protocol yourself.
</li><li class="listitem">
The jNut source is now here: <a class="ulink" href="https://github.com/networkupstools/jNut" target="_top">https://github.com/networkupstools/jNut</a>
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_6_4_to_2_6_5"></a>3.10. Changes from 2.6.4 to 2.6.5</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
users are encouraged to update to NUT 2.6.5, to fix a regression in
  upssched.
</li><li class="listitem">
mge-shut driver has been replaced by a new implementation (newmge-shut).
  In case of issue with this new version, users can revert to oldmge-shut.
  UPDATE: oldmge-shut was dropped between 2.7.4 and 2.8.0 releases.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_6_3_to_2_6_4"></a>3.11. Changes from 2.6.3 to 2.6.4</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
users are encouraged to update to NUT 2.6.4, to fix upsd vulnerability
  (CVE-2012-2944: upsd can be remotely crashed).
</li><li class="listitem">
users of the bestups driver are encouraged to switch to blazer_ser,
  since bestups will soon be deprecated.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_6_2_to_2_6_3"></a>3.12. Changes from 2.6.2 to 2.6.3</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_6_1_to_2_6_2"></a>3.13. Changes from 2.6.1 to 2.6.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
apcsmart driver has been replaced by a new implementation. In case of issue
  with this new version, users can revert to apcsmart-old.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_6_0_to_2_6_1"></a>3.14. Changes from 2.6.0 to 2.6.1</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_4_3_to_2_6_0"></a>3.15. Changes from 2.4.3 to 2.6.0</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
users of the megatec and megatec_usb drivers must respectively switch to
  blazer_ser and blazer_usb.
</li><li class="listitem">
users of the liebertgxt2 driver are advised that the driver name has changed
  to liebert-esp2.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_4_2_to_2_4_3"></a>3.16. Changes from 2.4.2 to 2.4.3</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_4_1_to_2_4_2"></a>3.17. Changes from 2.4.1 to 2.4.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The default subdriver for the blazer_usb driver USB id 06da:0003 has changed.
  If you use such a device and it is no longer working with this driver,
  override the <span class="emphasis"><em>subdriver</em></span> default in <span class="emphasis"><em>ups.conf</em></span> (see man 8 blazer).
</li><li class="listitem">
NUT ACL and the allowfrom mechanism has been replaced in 2.4.0 by the LISTEN
  directive and tcp-wrappers respectively. This information was missing below,
  so a double note has been added.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_4_0_to_2_4_1"></a>3.18. Changes from 2.4.0 to 2.4.1</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_2_2_to_2_4_0"></a>3.19. Changes from 2.2.2 to 2.4.0</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The nut.conf file has been introduced to standardize startup configuration
  across the various systems.
</li><li class="listitem">
The cpsups and nitram drivers have been replaced by the powerpanel driver,
  and removed from the tree. The cyberpower driver may suffer the same in the
  future.
</li><li class="listitem">
The al175 and energizerups drivers have been removed from the tree, since
  these were tagged broken for a long time.
</li><li class="listitem">
Developers of external client application using libupsclient must rename
  their "UPSCONN" client structure to "UPSCONN_t".
</li><li class="listitem">
The upsd server will now disconnect clients that remain silent for more than
  60 seconds.
</li><li class="listitem">
The files under scripts/python/client are distributed under GPL 3+, whereas
  the rest of the files are distributed under GPL 2+. Refer to COPYING for more
  information.
</li><li class="listitem">
The generated udev rules file has been renamed with dash only, no underscore
  anymore (i.e. 52-nut-usbups.rules instead of 52_nut-usbups.rules)
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_2_1_to_2_2_2"></a>3.20. Changes from 2.2.1 to 2.2.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The configure option "--with-lib" has been replaced by "--with-dev".
  This enable the additional build and distribution of the static
  version of libupsclient, along with the pkg-config helper and manual
  pages. The default configure option is to distribute only the shared
  version of libupsclient. This can be overridden by using the
  "--disable-shared" configure option (distribute static only binaries).
</li><li class="listitem">
The UPS poweroff handling of the usbhid-ups driver has been reworked.
  Though regression is not expected, users of this driver are
  encouraged to test this feature by calling "upsmon -c fsd" and
  report any issue on the NUT mailing lists.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_2_0_to_2_2_1"></a>3.21. Changes from 2.2.0 to 2.2.1</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
  (The below message is repeated due to previous omission)
</li><li class="listitem">
Developers of external client application using libupsclient are
  encouraged to rename their "UPSCONN" client structure to "UPSCONN_t"
  since the former will disappear by the release of NUT 2.4.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_0_5_to_2_2_0"></a>3.22. Changes from 2.0.5 to 2.2.0</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
users of the newhidups driver are advised that the driver name has changed
  to usbhid-ups.
</li><li class="listitem">
users of the hidups driver must switch to usbhid-ups.
</li><li class="listitem">
users of the following drivers (powermust, blazer, fentonups, mustek,
  esupssmart, ippon, sms) must switch to megatec, which replaces
  all these drivers.  Please refer to doc/megatec.txt for details.
</li><li class="listitem">
users of the mge-shut driver are encouraged to test newmge-shut, which
  is an alternate driver scheduled to replace mge-shut,
</li><li class="listitem">
users of the cpsups driver are encouraged to switch to powerpanel which
  is scheduled to replace cpsups,
</li><li class="listitem">
packagers will have to rework the whole nut packaging due to the
  major changes in the build system (completely modified, and now using
  automake). Refer to packaging/debian/ for an example of migration.
</li><li class="listitem">
specifying <span class="emphasis"><em>-a &lt;id&gt;</em></span> is now mandatory when starting a driver manually,
  i.e. not using upsdrvctl.
</li><li class="listitem">
Developers of external client application using libupsclient are
  encouraged to rename the "UPSCONN" client structure to "UPSCONN_t"
  since the former will disappear by the release of NUT 2.4.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_0_4_to_2_0_5"></a>3.23. Changes from 2.0.4 to 2.0.5</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
users of the newhidups driver: the driver is now more strict about
  refusing to connect to unknown devices. If your device was
  previously supported, but fails to be recognized now, add
  <span class="emphasis"><em>productid=XXXX</em></span> to ups.conf. Please report the device to the NUT
  developer’s mailing list.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_0_3_to_2_0_4"></a>3.24. Changes from 2.0.3 to 2.0.4</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
</li><li class="listitem">
users of the following drivers (powermust, blazer, fentonups, mustek,
  esupssmart, ippon, sms, masterguard) are encouraged to switch to megatec,
  which should replace all these drivers by nut 2.2. For more information,
  please refer to doc/megatec.txt
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_0_2_to_2_0_3"></a>3.25. Changes from 2.0.2 to 2.0.3</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
nothing that affects upgraded systems.
</li><li class="listitem">
hidups users are encouraged to switch to newhidups, as hidups will be
  removed by nut 2.2.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_0_1_to_2_0_2"></a>3.26. Changes from 2.0.1 to 2.0.2</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The newhidups driver, which is the long run USB support approach,
  needs hotplug files installed to setup the right permissions on
  device file to operate. Check newhidups manual page for more information.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_2_0_0_to_2_0_1"></a>3.27. Changes from 2.0.0 to 2.0.1</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The cyberpower1100 driver is now called cpsups since it supports
  more than just one model.  If you use this driver, be sure to remove
  the old binary and update your ups.conf <span class="emphasis"><em>driver=</em></span> setting with the
  new name.
</li><li class="listitem">
The upsstats.html template page has been changed slightly to reflect
  better HTML compliance, so you may want to update your installed copy
  accordingly.  If you’ve customized your file, don’t just copy the new
  one over it, or your changes will be lost!
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_changes_from_1_4_0_to_2_0_0"></a>3.28. Changes from 1.4.0 to 2.0.0</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
The sample config files are no longer installed by default.  If you
  want to install them, use <span class="emphasis"><em>make install-conf</em></span> for the main programs,
  and <span class="emphasis"><em>make install-cgi-conf</em></span> for the CGI programs.
</li><li class="listitem"><p class="simpara">
ACCESS is no longer supported in upsd.conf.  Use ACCEPT and REJECT.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p class="simpara">
Old way:
</p><pre class="literallayout">ACCESS grant all adminbox
ACCESS grant all webserver
ACCESS deny all all</pre></li><li class="listitem"><p class="simpara">
New way:
</p><pre class="literallayout">ACCEPT adminbox
ACCEPT webserver
REJECT all</pre></li><li class="listitem"><p class="simpara">
Note that ACCEPT and REJECT can take multiple arguments, so this
    will also work:
</p><pre class="literallayout">ACCEPT adminbox webserver
REJECT all</pre></li></ul></div></li><li class="listitem">
The drivers no longer support sddelay in ups.conf or -d on the
  command line.  If you need a delay after calling <span class="emphasis"><em>upsdrvctl
  shutdown</em></span>, add a call to sleep in your shutdown script.
</li><li class="listitem">
The templates used by upsstats have changed considerably to reflect
  the new variable names.  If you use upsstats, you will need to
  install new copies or edit your existing files to use the new names.
</li><li class="listitem">
Nobody needed UDP mode, so it has been removed.  The only users
  seemed to be a few people like me with ancient asapm-ups binaries.
  If you really want to run asapm-ups again, bug me for the new patch
  which makes it work with upsclient.
</li><li class="listitem">
<span class="emphasis"><em>make install-misc</em></span> is now <span class="emphasis"><em>make install-lib</em></span>.  The misc directory
  has been gone for a long time, and the target was ambiguous.
</li><li class="listitem">
The newapc driver has been renamed to apcsmart.  If you previously
  used newapc, make sure you delete the old binary and fix your
  ups.conf.  Otherwise, you may run the old driver from 1.4.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_file_trimmed_here_on_changes_from_1_2_2_to_1_4_0"></a>3.29. File trimmed here on changes from 1.2.2 to 1.4.0</h3></div></div></div><p>For information before this point, start with version 2.4.1 and work back.</p></div></div><div xmlns="" class="navfooter nut_footer"><hr />
		Last updated 2025-08-02 02:55:03 -- Network UPS Tools 2.8.3.762</div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="NUT_Release_Notes.html">Prev</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="Project_History.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>