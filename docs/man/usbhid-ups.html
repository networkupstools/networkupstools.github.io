<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 10.2.0" />
<title>USBHID-UPS(8)</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overridden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
<meta name="format-detection" content="telephone=no" />
</head>
<body class="article">
<div id="header">
<h1>USBHID-UPS(8)</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_name">NAME</h2>
<div class="sectionbody">
<div class="paragraph"><p>usbhid-ups - Driver for USB/HID UPS equipment</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_synopsis">SYNOPSIS</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>usbhid-ups</strong> -h</p></div>
<div class="paragraph"><p><strong>usbhid-ups</strong> -a <em>UPS_NAME</em> [<em>OPTIONS</em>]</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">This man page only documents the hardware-specific features of the
usbhid-ups driver.  For information about the core driver, see
<a href="nutupsdrv.html">nutupsdrv(8)</a>.</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supported_hardware">SUPPORTED HARDWARE</h2>
<div class="sectionbody">
<div class="paragraph"><p><strong>usbhid-ups</strong> brings USB/HID UPS monitoring to NUT on all platforms supporting
USB through libusb. It should detect any UPS that uses the HID Power Device
Class, but the amount of data will vary depending on the manufacturer and
model.</p></div>
<div class="paragraph"><p>At the present time, usbhid-ups supports:</p></div>
<div class="ulist"><ul>
<li>
<p>
the newer Eaton USB models,
</p>
</li>
<li>
<p>
all MGE USB models,
</p>
</li>
<li>
<p>
all Dell USB models,
</p>
</li>
<li>
<p>
all AMETEK Powervar UPM models,
</p>
</li>
<li>
<p>
some APC models,
</p>
</li>
<li>
<p>
some Belkin models,
</p>
</li>
<li>
<p>
some Cyber Power Systems models,
</p>
</li>
<li>
<p>
some Powercom models,
</p>
</li>
<li>
<p>
some PowerWalker models,
</p>
</li>
<li>
<p>
some TrippLite models.
</p>
</li>
</ul></div>
<div class="paragraph"><p>For a more complete list, refer to the NUT hardware compatibility list,
available in the NUT source distribution as <code>data/driver.list</code>, or on the
NUT website.</p></div>
<div class="paragraph"><p>You may use the <code>explore</code> driver option to gather information from HID UPSes
which are not yet supported, to help add such support; see below for details.</p></div>
<div class="paragraph"><p>This driver is known to work on:</p></div>
<div class="ulist"><ul>
<li>
<p>
most Linux systems,
</p>
</li>
<li>
<p>
FreeBSD (beta stage) and maybe other *BSD,
</p>
</li>
<li>
<p>
Darwin / Mac OS X,
</p>
</li>
<li>
<p>
Solaris 10 and illumos-based distributions.
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_extra_arguments">EXTRA ARGUMENTS</h2>
<div class="sectionbody">
<div class="paragraph"><p>This driver also supports the following optional settings:</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>port =</strong> <em>string</em>
</dt>
<dd>
<p>
Required option for all NUT drivers. Some <em>value</em> must be set, typically
<strong>auto</strong> for drivers that handle USB connections.
</p>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">This could be a device filesystem path like <code>/dev/usb/hiddev0</code>
but current use of libusb API precludes knowing and matching by such
identifiers.  They may also be inherently unreliable (dependent on
re-plugging and enumeration order). At this time the actual <em>value</em>
is ignored, but syntactically some <em>port</em> configuration must still
be there.</td>
</tr></table>
</div>
</dd>
</dl></div>
<div class="paragraph"><p>It is possible to control multiple UPS units simultaneously by running
several instances of this driver, provided they can be uniquely
distinguished by setting some combination of the <strong>vendor</strong>, <strong>product</strong>,
<strong>vendorid</strong>, <strong>productid</strong>, <strong>serial</strong>, <strong>bus</strong> and/or <strong>device</strong> options detailed
below.  For devices or operating systems that do not provide sufficient
information, the <strong>allow_duplicates</strong> option can be of use (limited and
risky!)</p></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>vendorid =</strong> <em>regex</em>
</dt>
<dt class="hdlist1">
<strong>productid =</strong> <em>regex</em>
</dt>
<dt class="hdlist1">
<strong>vendor =</strong> <em>regex</em>
</dt>
<dt class="hdlist1">
<strong>product =</strong> <em>regex</em>
</dt>
<dt class="hdlist1">
<strong>serial =</strong> <em>regex</em>
</dt>
<dd>
<p>
Select a specific UPS, in case there is more than one connected via
USB. Each option specifies an extended regular expression (see
<ulink url="https://linux.die.net/man/7/regex">regex(7)</ulink> for more information on regular expressions), which
must match the UPS&#8217;s entire respective <code>vendor</code>/<code>product</code>/<code>serial</code>
string values (minus any surrounding whitespace), or the whole 4-digit
hexadecimal code for <code>vendorid</code> and <code>productid</code>.
</p>
<div class="paragraph"><p>Try <ulink url="https://linux.die.net/man/8/lsusb">lsusb(8)</ulink> or running this NUT driver with <code>-DD</code> command-line
argument for finding out the strings to match.</p></div>
<div class="paragraph"><p>Examples:</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>-x vendor="Foo.Corporation.*"</code>
</p>
</li>
<li>
<p>
<code>-x vendorid="051d*"</code> (APC)
</p>
</li>
<li>
<p>
<code>-x product=".*(Smart|Back)-?UPS.*"</code>
</p>
</li>
</ul></div>
</dd>
<dt class="hdlist1">
<strong>bus =</strong> <em>regex</em>
</dt>
<dd>
<p>
OPTIONAL, NOT RECOMMENDED.
</p>
<div class="paragraph"><p>Select a UPS on a specific USB bus or group of buses. The argument is
a regular expression that must match the bus name where the UPS is
connected (e.g. <code>bus="002"</code> or <code>bus="00[2-3]"</code>) as seen on Linux in
<code>/sys/bus/usb/devices</code> or <ulink url="https://linux.die.net/man/8/lsusb">lsusb(8)</ulink>; including leading zeroes.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Bus numbers are not guaranteed by the OS to be stable across
re-boots, kernel driver reloads or device re-plugging (e.g. changing
visible population of USB hubs).</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>device =</strong> <em>regex</em>
</dt>
<dd>
<p>
OPTIONAL, NOT RECOMMENDED.
</p>
<div class="paragraph"><p>Select a UPS on a specific USB device or group of devices. The argument is
a regular expression that must match the device name where the UPS is
connected (e.g. <code>device="001"</code> or <code>device="00[1-2]"</code>) as seen on Linux
in <code>/sys/bus/usb/devices</code> or <ulink url="https://linux.die.net/man/8/lsusb">lsusb(8)</ulink>; including leading zeroes.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">Device numbers are not guaranteed by the OS to be stable across
re-boots or device re-plugging.</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>busport =</strong> <em>regex</em>
</dt>
<dd>
<p>
OPTIONAL, NOT RECOMMENDED.
</p>
<div class="paragraph"><p>If supported by the hardware, OS and libusb on the particular deployment,
this option should allow to specify physical port numbers on an USB hub,
rather than logical <code>device</code> enumeration values, and in turn&#8201;&#8212;&#8201;this should
be less volatile across reboots or re-plugging. The value may be seen in
the USB topology output of <code>lsusb -tv</code> on systems with that tool, for example.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">This option is not practically supported by some NUT builds
(it should be ignored with a warning then), and not by all systems
that NUT can run on.</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>allow_duplicates</strong>
</dt>
<dd>
<p>
OPTIONAL, NOT RECOMMENDED.
</p>
<div class="paragraph"><p>If you have several UPS devices which may not be uniquely identified by
the options above (e.g. only <em>VID:PID</em> can be discovered there), this flag
allows each driver instance where it is set to take the first match if
available, or proceed to try another.</p></div>
<div class="paragraph"><p>Normally the driver initialization would abort at this point claiming
"Resource busy" or similar error, assuming that the otherwise properly
matched device is unique&#8201;&#8212;&#8201;and some other process already handles it.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph"><p>This feature is inherently non-deterministic!
The association of driver instance name to actual device
may vary between runs!</p></div>
<div class="paragraph"><p>If you only care to know that <strong>at least</strong> one of your no-name UPSes
is online, this option can help.</p></div>
<div class="paragraph"><p>If you must really know <strong>which</strong> one, it will not!</p></div>
</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>usb_set_altinterface =</strong> <em>bAlternateSetting</em>
</dt>
<dd>
<p>
Force redundant call to <code>usb_set_altinterface()</code>, especially if needed
for devices serving multiple USB roles where the UPS is not represented
by the interface number <code>0</code> (default).
</p>
</dd>
<dt class="hdlist1">
<strong>usb_config_index</strong>
</dt>
<dt class="hdlist1">
<strong>usb_hid_rep_index</strong>
</dt>
<dt class="hdlist1">
<strong>usb_hid_desc_index</strong>
</dt>
<dt class="hdlist1">
<strong>usb_hid_ep_in</strong>
</dt>
<dt class="hdlist1">
<strong>usb_hid_ep_out</strong>
</dt>
<dd>
<p>
Force use of specific interface, endpoint, descriptor index etc. numbers,
rather than defaulting to <em>0</em> (rarely other values in certain drivers for
some devices known to use non-zero numbers). Specified as a hexadecimal
number.
</p>
<div class="paragraph"><p>As a rule of thumb for <code>usb_hid_desc_index</code> discovery, you can see larger
<code>wDescriptorLength</code> values (roughly 600+ bytes) in reports of <code>lsusb</code> or
similar tools.</p></div>
</dd>
<dt class="hdlist1">
<strong>LIBUSB_DEBUG =</strong> <em>INTEGER</em>
</dt>
<dd>
<p>
Run-time troubleshooting of USB-capable NUT drivers can involve not only
raising the common NUT debug verbosity (e.g. using the <code>DEBUG_MIN</code> setting
in <a href="ups.conf.html">ups.conf(5)</a> or protocol commands to change the <code>driver.debug</code>
value), but may also benefit from LibUSB specific debugging.
</p>
<div class="paragraph"><p>For the latter, you can set the <code>LIBUSB_DEBUG</code> driver option; alternatively
you can classically export the environment variable <code>LIBUSB_DEBUG</code> before
starting a NUT driver program (may be set and "exported" in driver init
script or service method, perhaps via <a href="nut.conf.html">nut.conf(5)</a>), to a numeric
value such as <code>4</code> ("All messages are emitted").</p></div>
<div class="paragraph"><p>For more details, including the currently supported values for your version
of the library, see e.g.:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="https://libusb.sourceforge.io/api-1.0/">https://libusb.sourceforge.io/api-1.0/</a>
</p>
</li>
<li>
<p>
<a href="https://libusb.sourceforge.io/api-1.0/group__libusb__lib.html">https://libusb.sourceforge.io/api-1.0/group__libusb__lib.html</a>
</p>
</li>
</ul></div>
</dd>
</dl></div>
<div class="dlist"><dl>
<dt class="hdlist1">
<strong>subdriver</strong>=<em>regex</em>
</dt>
<dd>
<p>
Select the USB HID subdriver for the device manually, where automatic match
by device attributes alone does not suffice (e.g. new devices for which no
<code>vendorid</code>/<code>productid</code> pair was built into any driver&#8201;&#8212;&#8201;but common USB HID
support is anticipated, or for different-capability devices with same
interface chips, notably "phoenixtec/liebert" and "mge").
</p>
<div class="paragraph"><p>Run the driver program with the <code>--help</code> option to see the exact list of
<code>subdriver</code> values it would currently recognize.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">This option first checks for exact matches to subdriver identification
strings, such as <code>"TrippLite HID 0.85"</code> (which are prone to bit-rot), and if
there was no exact match&#8201;&#8212;&#8201;retries with a case-insensitive extended regular
expression.</td>
</tr></table>
</div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">When using this option, it is mandatory to also specify the <strong>vendorid</strong>
and <strong>productid</strong> matching parameters.</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>lowbatt</strong>=<em>num</em>
</dt>
<dd>
<p>
Set the percentage at which the UPS will consider the battery charge as
critically low, possibly resulting in a forced shutdown (FSD) situation.
</p>
<div class="paragraph"><p>This value is typically dictated by the UPS device, although there is a
fallback default value of 30 (in percent). Overriding this value can be
helpful when the UPS sets this value to a lower percentage than intended.</p></div>
</dd>
<dt class="hdlist1">
<strong>offdelay</strong>=<em>num</em>
</dt>
<dd>
<p>
Set the timer before the UPS is turned off after the kill power command is
sent (via the <strong>-k</strong> switch).
</p>
<div class="paragraph"><p>The default value is 20 (in seconds), or 60 for CPS devices.
Usually this <strong>must be lower</strong> than <em>ondelay</em>, but the driver will <strong>not</strong> warn
you upon startup if it isn&#8217;t.</p></div>
<div class="paragraph"><p>Note that many Cyber Power Systems (CPS) models tend to divide this delay by
60 and round down, so the minimum advisable value is 60 to avoid powering off
immediately after NUT sends the shutdown command to the UPS. More details
below.</p></div>
</dd>
<dt class="hdlist1">
<strong>ondelay</strong>=<em>num</em>
</dt>
<dd>
<p>
Set the timer for the UPS to switch on in case the power returns after the
kill power command had been sent, but before the actual switch off. This
ensures the machines connected to the UPS are, in all cases, rebooted after
a power failure.
</p>
<div class="paragraph"><p>The default value is 30 (in seconds), or 120 for CPS devices.
Usually this <strong>must be greater</strong> than offdelay, but the driver will <strong>not</strong> warn
you upon startup if it isn&#8217;t. Some UPSes will restart no matter what, even
if the power is (still) out at the moment this timer elapses. In that case,
you could see whether setting <code>ondelay = -1</code> in <strong>ups.conf</strong> helps.</p></div>
<div class="paragraph"><p>Note that many CPS models tend to divide this delay by 60 and round down, so
the minimum advisable value is 120 to allow a short delay between when the UPS
shuts down, and when the power returns. According to support statement (for at
least some CPS models), "our UPS systems are unable to set up power on delay".</p></div>
</dd>
<dt class="hdlist1">
<strong>pollfreq</strong>=<em>num</em>
</dt>
<dd>
<p>
Set polling frequency for full updates, in seconds. Compared to the quick
updates performed every "pollinterval" (the latter option is described in
<a href="ups.conf.html">ups.conf(5)</a>), the "pollfreq" interval is for polling the less-critical
variables.  The default value is 30 (in seconds), or 12 sec for CPS devices.
</p>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">This setting is different from a <code>POLLFREQ</code> supported by <a href="upsmon.html">upsmon(8)</a>
(for details see its <a href="upsmon.conf.html">upsmon.conf(5)</a>).</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>pollonly</strong>
</dt>
<dd>
<p>
If this flag is set, the driver will not use Interrupt In transfers during the
shorter "pollinterval" cycles (not recommended, but needed if these reports
are broken on your UPS).
</p>
</dd>
<dt class="hdlist1">
<strong>interrupt_pipe_no_events_tolerance</strong>=<em>num</em>
</dt>
<dd>
<p>
Set the tolerance for how many times in a row could we have "Got 0 HID objects"
when using USB interrupt mode?  This may normally be due to a device having
nothing urgent to report, so the default value is <code>-1</code> and this situation is
not handled in any way specially.  However with some devices this was seen
in conjunction with a frozen controller, where only a driver reconnection
restored the data exchange (e.g. APC BXnnnnMI)&#8201;&#8212;&#8201;in such cases you may want
to use a reasonable non-negative value here.
</p>
</dd>
<dt class="hdlist1">
<strong>onlinedischarge_battery</strong>
</dt>
<dd>
<p>
If this flag is set, the driver will treat <code>OL+DISCHRG</code> status as
offline/on-battery.
</p>
<div class="paragraph"><p>For most devices this combination means calibration or similar maintenance;
however some UPS models (e.g. CyberPower UT series) emit <code>OL+DISCHRG</code> when
wall power is lost&#8201;&#8212;&#8201;and need this option to handle shutdowns.</p></div>
</dd>
<dt class="hdlist1">
<strong>onlinedischarge</strong>
</dt>
<dd>
<p>
DEPRECATED, old name for <code>onlinedischarge_battery</code> described above.
</p>
</dd>
<dt class="hdlist1">
<strong>onlinedischarge_calibration</strong>
</dt>
<dd>
<p>
If this flag is set, the driver will treat <code>OL+DISCHRG</code> status as calibration.
Some UPS models (e.g. APC were seen to do so) report <code>OL+DISCHRG</code> when they
are in calibration mode. This usually happens after a few seconds reporting
an <code>OFF</code> state as well, while the hardware is switching to on-battery mode.
</p>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">If it takes so long on your device that a shutdown gets issued, you may
want to look at <code>upsmon</code> option <code>OFFDURATION</code> used to filter out temporary
values of "administrative OFF" as not a loss of a feed for the powered load.</td>
</tr></table>
</div>
</dd>
<dt class="hdlist1">
<strong>onlinedischarge_log_throttle_sec</strong>=<em>num</em>
</dt>
<dd>
<p>
Set the minimum frequency (in seconds) at which warnings would be emitted
for an otherwise not handled <code>OL+DISCHRG</code> device status combination.
Negative values disable sequentially repeated messages (when this state
appears and persists).
</p>
<div class="paragraph"><p>If the device does not report <code>battery.charge</code>, the default value is 30 seconds
(fairly frequent, in case the UPS-reported state combination does reflect a
bad power condition and so the situation is urgent).</p></div>
<div class="paragraph"><p>If it does report <code>battery.charge</code>, by default the repeated notifications
would only be logged if this charge is different from when the message was
emitted previously (e.g. when the battery is really discharging).</p></div>
<div class="paragraph"><p>If both this option is set, and <code>battery.charge</code> is correctly reported,
either of these rules allow the notification to be logged.</p></div>
</dd>
<dt class="hdlist1">
<strong>onlinedischarge_log_throttle_hovercharge</strong>=<em>num</em>
</dt>
<dd>
<p>
See details in <code>onlinedischarge_log_throttle_sec</code> and <code>battery.charge</code> based
log message throttling description above.  This option adds a concept of UPS
"hovering" a battery charge at some level deemed safe for its chemistry, and
not forcing it to be fully charged all the time.  As long as the current value
of <code>battery.charge</code> remains at or above this threshold percentage (default 100),
the <code>OL+DISCHRG</code> message logging is not triggered by variations of the charge.
</p>
</dd>
<dt class="hdlist1">
<strong>lbrb_log_delay_sec</strong>=<em>num</em>
</dt>
<dd>
<p>
Set to delay status-setting (and log messages) about device entering <code>LB</code> or
<code>LB+RB</code> state.
</p>
<div class="paragraph"><p>Some APC BXnnnnMI device models or firmware versions (reportedly 2023-2024),
or APC BVKnnnnM2 device models, or APC BKnnnnM2-CH (a China-market-only model),
frequently report "low battery", "replace battery", and "all ok" states
changing rapidly within a couple of seconds, sometimes (but not always)
preceded by <code>OL+DISCHRG</code> (presumably calibration).</p></div>
<div class="paragraph"><p>This setting lets the driver ignore short-lived states and only pay attention
if they persist longer than this setting (and the device power state is <code>OL</code>).</p></div>
</dd>
<dt class="hdlist1">
<strong>lbrb_log_delay_without_calibrating</strong>
</dt>
<dd>
<p>
Set to apply <code>lbrb_log_delay_sec</code> even if device is not calibrating.
</p>
</dd>
<dt class="hdlist1">
<strong>disable_fix_report_desc</strong>
</dt>
<dd>
<p>
Set to disable fix-ups for broken USB encoding, etc. which we apply by default
on certain models (vendors/products) which were reported as not following the
protocol strictly. This flag allows to disable the feature in particular device
configurations.
</p>
<div class="paragraph"><p>It is always possible that the vendors eventually release fixed firmware, or
re-use identifiers by which we match suspected broken devices for unrelated
products, so processing these fix-ups would be a waste of time there.</p></div>
<div class="paragraph"><p>It is also always possible that NUT fix-ups cause issues on some devices,
whether due to NUT bugs or because the vendor protocol implementation is
broken in more than one place.</p></div>
</dd>
<dt class="hdlist1">
<strong>powercom_sdcmd_byte_order_fallback</strong>
</dt>
<dd>
<p>
Original <code>PowerCOM HID</code> subdriver code (until version 0.7) sent UPS <code>shutdown</code>
and <code>stayoff</code> commands in a wrong byte order, than what is needed by actual
devices seen in the field in 2024.  The byte order is fixed to satisfy new
devices by default since version 0.71.  Just in case there are different
firmwares out there with opposite behaviors, we provide this toggle to use
old behavior in a particular deployment.  Maybe it was just a bug and nobody
needs this fall-back&#8230;
</p>
</dd>
<dt class="hdlist1">
<strong>explore</strong>
</dt>
<dd>
<p>
With this option, the driver will connect to any device, including
ones that are not yet supported. This must always be combined with the
"vendorid" option. In this mode, the driver will not do anything
useful except for printing debugging information (typically used with
-DD).
</p>
</dd>
<dt class="hdlist1">
<strong>maxreport</strong>
</dt>
<dd>
<p>
With this option, the driver activates a tweak to workaround buggy firmware
returning invalid HID report length. Some APC Back-UPS units are known to have
this bug.
</p>
</dd>
<dt class="hdlist1">
<strong>interruptonly</strong>
</dt>
<dd>
<p>
If this flag is set, the driver will not poll UPS. This also implies using of
INPUT flagged objects. Some Powercom units need this option.
</p>
</dd>
<dt class="hdlist1">
<strong>interruptsize</strong>=<em>num</em>
</dt>
<dd>
<p>
Limit the number of bytes to read from interrupt pipe. For some Powercom units
this option should be equal to 8.
</p>
</dd>
<dt class="hdlist1">
<strong>waitbeforereconnect</strong>=<em>num</em>
</dt>
<dd>
<p>
The driver automatically tries to reconnect to the UPS on unexpected error.
This parameter (in seconds) allows it to wait before attempting the reconnection.
The default value is 0.
</p>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">for instance, it was found that Eaton MGE Ellipse Max 1500 FR UPS firmware
stops responding every few hours, which causes usbhid-ups driver to detect an
libusb insufficient memory error; in this case, when the usbhid-ups driver tries
to reconnect too early, the activity sometimes led the UPS firmware to crash and
turn off the load immediately! Setting this parameter to 30 seconds solved this
problem (while 20 seconds were not enough).</td>
</tr></table>
</div>
</dd>
</dl></div>
</div>
</div>
<div class="sect1">
<h2 id="_installation">INSTALLATION</h2>
<div class="sectionbody">
<div class="paragraph"><p>This driver may be not built by default.  You can build it by installing
prerequisites and using <code>configure --with-usb=yes</code>. Note that it will also
install other USB drivers.</p></div>
<div class="paragraph"><p>You also need to install manually the legacy <strong>hotplug</strong> files (<code>libhidups</code>
and <code>libhid.usermap</code>, generally in <code>/etc/hotplug/usb/</code>), or the <strong>udev</strong> file
(<code>nut-usbups.rules</code>, generally in <code>/etc/udev/rules.d/</code>) to address the
permission settings problem. For more information, refer to the
<code>scripts/hotplug/README.adoc</code> or <code>scripts/udev/README.adoc</code> files in NUT
sources.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation">IMPLEMENTATION</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_selecting_a_specific_ups">Selecting a specific UPS</h3>
<div class="paragraph"><p>As mentioned above, the driver ignores the "port" value in <strong>ups.conf</strong>.</p></div>
<div class="paragraph"><p>Unlike previous versions of this driver, it is now possible to control
multiple UPS units simultaneously with instances of this driver running
in parallel, provided they can be distinguished by setting some combination
of the device-matching options.</p></div>
<div class="paragraph"><p>For example:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>[mge]
        driver = usbhid-ups
        port = auto
        vendorid = 0463
[tripplite]
        driver = usbhid-ups
        port = auto
        vendorid = 09ae</code></pre>
</div></div>
<div class="paragraph"><p>To monitor devices using the same vendor and product identification (e.g.
two pieces of the same model), you would need to find a reliable unique
matching criteria:</p></div>
<div class="ulist"><ul>
<li>
<p>
The <em>serial</em> number is the best option, if populated.
</p>
</li>
<li>
<p>
Link-level <code>bus</code>/<code>device</code>/<code>busport</code> may be unreliable (due to re-enumeration
  on a whim by the operating system).
</p>
</li>
<li>
<p>
If nothing else helps, <code>allow_duplicates</code> may be an option in some cases.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_usb_polling_and_interrupt_transfers">USB Polling and Interrupt Transfers</h3>
<div class="paragraph"><p>The <strong>usbhid-ups</strong> driver has two polling intervals. The "pollinterval"
configuration option controls what can be considered the "inner loop", where
the driver polls and waits briefly for "interrupt" reports. The "pollfreq"
option is for less frequent updates of a larger set of values, and as such, we
recommend setting that interval to several times the value of "pollinterval".</p></div>
<div class="paragraph"><p>Many UPSes will respond to a USB Interrupt In transfer with HID reports
corresponding to values which have changed. This saves the driver from having
to poll each value individually with USB Control transfers. Since the <code>OB</code> and
<code>LB</code> status flags are important for a clean shutdown, the driver also
explicitly polls the HID paths corresponding to those status bits during the
inner "pollinterval" time period. The "pollonly" option can be used to skip
the Interrupt In transfers if they are known not to work.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_known_issues_and_bugs">KNOWN ISSUES AND BUGS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_ups_reports_65535_sec_or_18_12_15_of_battery_runtime_capability">UPS reports 65535 sec (or 18:12:15) of battery.runtime capability</h3>
<div class="paragraph"><p>From a number of reports, it seems that some devices either can not report
more than a 16-bit unsigned value in the standard field for remaining run
time (vendor extended fields may exist but be unknown to the mapping tables
in your current NUT driver build), or return <code>-1</code> for error and that gets
treated as an unsigned 16-bit 65535 value.</p></div>
<div class="paragraph"><p>According to some issue discussions, passing a battery test (calibration)
can help the UPS re-estimate the time more correctly.</p></div>
<div class="paragraph"><p>This problem may also be linked to a very lightly loaded large-capacity UPS.
In some cases vendor documentation explicitly states that runtime calculation
is not reliable with loads under e.g. 10%.</p></div>
</div>
<div class="sect2">
<h3 id="_repetitive_timeout_and_staleness">Repetitive timeout and staleness</h3>
<div class="paragraph"><p>Some models tends to be unresponsive with the default polling frequency.
The result is that your system log will have lots of messages like:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>usb 2-1: control timeout on ep0in
usb 2-1: usbfs: USBDEVFS_CONTROL failed cmd usbhid-ups rqt 128 rq 6 len 256
ret -110</code></pre>
</div></div>
<div class="paragraph"><p>In this case, simply modify the general parameter "pollinterval" to a higher
value (such as 10 seconds). This should solve the issue.</p></div>
<div class="paragraph"><p>Note that if you increase "pollinterval" beyond 10 or 15 seconds, you might
also want to increase "pollfreq" by the same factor.</p></div>
<div class="paragraph"><p>With certain devices and operating systems, notably MGE/Eaton USB Vendor ID
(<code>0x0463</code>) on some versions of the Linux kernel, you might encounter poor
interaction with the "USB HID quirk" mechanism, which precludes Linux from
seeing the device as a <code>hid-generic</code> first, to hand it over to a NUT driver
later. For more details, see the NUT FAQ document. This particular quirk can
be tuned with a kernel boot parameter (via GRUB etc.):</p></div>
<div class="literalblock">
<div class="content">
<pre><code>usbhid.quirks=0x0463:0xffff:0x08</code></pre>
</div></div>
<div class="paragraph"><p>Conversely, some hardware controllers may "fall asleep" when not contacted
for too long; CPS devices are commonly associated with such behaviour.
In this case, consider enabling <code>pollonly</code> flag and/or keeping <code>pollfreq</code>
and/or <code>pollinterval</code> small.</p></div>
</div>
<div class="sect2">
<h3 id="_got_eperm_operation_not_permitted_upon_driver_startup">Got EPERM: Operation not permitted upon driver startup</h3>
<div class="paragraph"><p>You have forgotten to install the hotplug files, as explained
in the INSTALLATION section above. Don&#8217;t forget to restart
hotplug so that it applies these changes.</p></div>
</div>
<div class="sect2">
<h3 id="_unattended_shutdowns">Unattended shutdowns</h3>
<div class="paragraph"><p>The hardware which was used for development of this driver is almost
certainly different from what you have, and not all manufacturers follow
the USB HID Power Device Class specifications to the letter. You don&#8217;t
want to find out that yours has issues here when a power failure hits
your server room and you&#8217;re not around to manually restart your servers.</p></div>
<div class="paragraph"><p>If you rely on the UPS to shutdown your systems in case of mains failure
and to restart them when the power returns, you <strong>must</strong> test this. You
can do so by running <em>upsmon -c fsd</em>. With the mains present, this should
bring your systems down and then cycle the power to restart them again.
If you do the same without mains present, it should do the same, but in
this case, the outputs shall remain off until mains power is applied
again.</p></div>
</div>
<div class="sect2">
<h3 id="_ups_cuts_power_too_soon">UPS cuts power too soon</h3>
<div class="paragraph"><p>Note that many Cyber Power Systems (CPS) models tend to divide <code>offdelay</code>
by 60 and round down, so the minimum advisable value is 60 (seconds) to avoid
powering off immediately after NUT sends the shutdown command to the UPS.</p></div>
<div class="paragraph"><p>For many Cyberpower UPSs, <code>offdelay</code> must be set to <code>0</code> for normal behavior
(the load is restored when AC power returns).  Setting <code>offdelay</code> above <code>0</code>
will restart the UPS load <strong>regardless of whether or not power has returned</strong>,
and setting <code>offdelay</code> below <code>0</code> will disable the auto-power-on function of
the UPS, keeping the load off even when power returns.</p></div>
</div>
<div class="sect2">
<h3 id="_ups_does_not_set_battery_charge_low_but_says_ok">UPS does not set battery.charge.low but says OK</h3>
<div class="paragraph"><p>Note that many Cyber Power Systems (CPS) models tend to allow only certain
values for <code>battery.charge.low</code> and anything outside of the set of allowed
values are rounded or ignored.</p></div>
<div class="paragraph"><p>A shell loop like this can help you map out the allowed values:</p></div>
<div class="exampleblock">
<div class="content">
<div class="literalblock">
<div class="content">
<pre><code>for i in `seq 90 -1 0`; do echo "set to $i"; \
    upsrw -s battery.charge.low=$i -u * -p * cps-big; \
    sleep 1; upsc cps-big battery.charge.low; echo ""; \
done</code></pre>
</div></div>
</div></div>
<div class="paragraph"><p>For example, for CPS PR1000LCDRTXL2U model, the only allowed values are
<code>[60,55,50,45,40,35,30,25,20]</code> and in some cases, your UPS may effectively
not support a value of 10 for the <code>battery.charge.low</code> setting.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_history">HISTORY</h2>
<div class="sectionbody">
<div class="paragraph"><p>This driver, formerly called <em>newhidups</em>, replaces the legacy <em>hidups</em> driver,
which only supported Linux systems.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_authors">AUTHORS</h2>
<div class="sectionbody">
<div class="paragraph"><p>Originally sponsored by MGE UPS SYSTEMS.</p></div>
<div class="paragraph"><p>Now sponsored by Eaton <a href="http://opensource.eaton.com">http://opensource.eaton.com</a></p></div>
<div class="ulist"><ul>
<li>
<p>
Arnaud Quette
</p>
</li>
<li>
<p>
Peter Selinger
</p>
</li>
<li>
<p>
Arjen de Korte
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_see_also">SEE ALSO</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_core_driver">The core driver</h3>
<div class="paragraph"><p><a href="nutupsdrv.html">nutupsdrv(8)</a></p></div>
</div>
<div class="sect2">
<h3 id="_internet_resources">Internet resources</h3>
<div class="paragraph"><p>The NUT (Network UPS Tools) home page: <a href="https://www.networkupstools.org/">https://www.networkupstools.org/</a></p></div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2025-07-18 17:44:32 UTC -- Network UPS Tools 2.8.3.707
</div>
</div>
</body>
</html>
