<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<title>Network UPS Tools - Voltronic Power - &#8216;QS&#8217; UPS communication protocols</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 10.1.2" />
<meta name="description" content="Power Devices support" />
<meta name="keywords" content="NUT, Network UPS Tools, Eaton, APC, Free Software, UPS, Uninterruptible Power Supplies, PDU, Power Distributions Units, Solar Controllers, power, power devices, control, monitor, Linux, Unix, Windows, Mac OS X" />
<meta name="format-detection" content="telephone=no" />
<link rel="stylesheet" href="../css/xhtml11.css" type="text/css" />
<link rel="stylesheet" href="../css/web-layout.css" type="text/css" />
<link rel="shortcut icon" href="../faviconut.ico" />
<link rel="icon" type="image/png" href="../faviconut.png" />
<script type="text/javascript" src="../scripts/asciidoc.js"></script>
<script type="text/javascript">
/*<![CDATA[*/
asciidoc.install(2);
/*]]>*/
</script>
<!--[if lte IE 7]>
<link rel="stylesheet" href="../css/ie-overrides.css" type="text/css" />
<![endif]-->
<!--[if lte IE 6]>
<script type="text/javascript" src="../scripts/filter_png.js"></script>
<![endif]-->
</head>
<body>
<div id="layout-banner-box">
<div id="layout-banner">
  <div id="layout-logo"><img src="../images/nut-logo.png" alt="NUT logo" /></div>
  <div id="layout-title">Network UPS Tools</div>
  <div id="layout-description">Power Devices support</div>
</div>
</div>
<div id="layout-menu-box">
  <ul id="layout-menu">
    <li><a href="../index.html">Home</a></li>
    <li><a href="../download.html">Download</a></li>
    <li><a href="../projects.html">Related projects</a></li>
    <li><a href="../stable-hcl.html">Compatibility</a></li>
    <li><a href="../features.html">Features</a></li>
    <li><a href="../documentation.html">Documentation</a></li>
    <li><a href="../support.html">Support</a></li>
    <li>* <a href="https://alioth-lists.debian.net/pipermail/nut-upsuser/">NUT UPS User archive</a></li>
    <li>* <a href="https://alioth-lists.debian.net/pipermail/nut-upsdev/">NUT UPS Dev archive</a></li>
    <li>* <a href="https://github.com/networkupstools/nut/">GitHub</a>:<a
        href="https://github.com/networkupstools/nut/issues">issues</a>,<a
        href="https://github.com/networkupstools/nut/wiki">wiki</a>
        and more</li>
    <li><a href="..//historic/index.html">Sub-sites for historic releases</a></li>
    <li><a href="https://opencollective.com/networkupstools/">Sponsor NUT</a></li>
  </ul>
  <!-- div id="sponsor"><span>Hosted by<br/></span>
    <a href="http://sponsor.com"><img src="../images/sponsor-logo.png" alt="Sponsor" /></a>
  </div -->
</div>
<div id="layout-content-box">
<div id="layout-content">
<div id="header">
<h1>Voltronic Power - &#8216;QS&#8217; UPS communication protocols</h1>
<span id="author">Daniele Pezzini</span><br />
<span id="email"><tt>&lt;<a href="mailto:hyouko@gmail.com">hyouko@gmail.com</a>&gt;</tt></span><br />
<span id="revision">version 2.0,</span>
November 2015
</div>
<div id="toc">
  <div id="toctitle">Table of Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>This document describes the RS232 and USB communication protocols used in some UPS manufactured by Voltronic Power.
It started as an &#8220;unofficial decoding work&#8221; and was later updated with protocol specifications kindly provided by Voltronic Power.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_hardware_description">Hardware description</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_rs232">RS232</h3>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
Baud rate
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
2400 bps
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Data length
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
8 bits
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Stop bit
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
1 bit
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Parity
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
none
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Cabling
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
9 pins female D-type connector - only 3 wires: TX, RX (crossed) and GND:
</p>
<div class="listingblock">
<div class="content">
<pre><code>  COMPUTER         UPS
=======================
 RX  (pin 2) &lt;---&gt; TX
 TX  (pin 3) &lt;---&gt; RX
 GND (pin 5) &lt;---&gt; GND</code></pre>
</div></div>
</td>
</tr>
</table></div>
</div>
<div class="sect2">
<h3 id="_usb">USB</h3>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
Communication
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Serial over USB with <em>cypress</em> protocol
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Cabling
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
<span class="image">
<img src="images/voltronic-qs_usb-scheme.png" alt="USB scheme" />
</span>
</p>
</td>
</tr>
</table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general">General</h2>
<div class="sectionbody">
<div class="ulist"><ul>
<li>
<p>
All <a href="#queries">inquiry</a> and <a href="#commands">control</a> commands and UPS&#8217;s replies are terminated by <code>&lt;cr&gt;</code>.
</p>
</li>
<li>
<p>
Valid <a href="#queries">inquiry commands</a> will get a reply terminated by <code>&lt;cr&gt;</code>:
</p>
<div class="ulist"><ul>
<li>
<p>
In a UPS&#8217;s reply, unavailable or not supported data is filled with <strong><code>-</code></strong>.
</p>
</li>
<li>
<p>
In a UPS&#8217;s reply, if some data length is less than the definition, there will be enough <strong><code>#</code></strong> before the data to reach the expected length.
</p>
</li>
</ul></div>
</li>
<li>
<p>
Accepted <a href="#commands">control commands</a> are followed by action without any further reply.
</p>
</li>
<li>
<p>
When invalid <a href="#commands">control</a> or <a href="#queries">inquiry</a> commands are sent to the UPS:
</p>
<div class="ulist"><ul>
<li>
<p>
<a id="P-protocol-invalid"></a><a href="#protocol">P protocol</a>:
</p>
<div class="ulist"><ul>
<li>
<p>
if the command/query starts with <code>T</code>, the device doesn&#8217;t reply anything,
</p>
</li>
<li>
<p>
otherwise the device replies <code>N&lt;cr&gt;</code>.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<a id="T-protocol-invalid"></a><a href="#protocol">T protocol</a>:
</p>
<div class="ulist"><ul>
<li>
<p>
the device replies <code>N&lt;cr&gt;</code>.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<a id="V-protocol-invalid"></a><a href="#protocol">V protocol</a>:
</p>
<div class="ulist"><ul>
<li>
<p>
the device echoes back the invalid command/query.
</p>
</li>
</ul></div>
</li>
</ul></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="queries">Inquiry commands</h2>
<div class="sectionbody">
<div class="paragraph"><p>By sending inquiry commands you can get the information you need from the UPS.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../images/note.png" alt="Note" />
</td>
<td class="content">To get a valid reply, all data should be captured at the same time when UPS receives an inquiry command.</td>
</tr></table>
</div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<a id="protocol"></a><strong><code>M</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Query UPS for protocol.
</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Reply</div>
<div class="content">
<pre><code>X&lt;cr&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Where <code>X</code> can be:</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>P</code> &#8594; P protocol:
</p>
<div class="ulist"><ul>
<li>
<p>
&#8594; <a href="#P-protocol-queries">inquiry commands</a>;
</p>
</li>
<li>
<p>
&#8594; <a href="#P-protocol-commands">control commands</a>;
</p>
</li>
<li>
<p>
&#8594; <a href="#P-protocol-invalid">handling of invalid commands</a>.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<code>T</code> &#8594; T protocol:
</p>
<div class="ulist"><ul>
<li>
<p>
&#8594; <a href="#T-protocol-queries">inquiry commands</a>;
</p>
</li>
<li>
<p>
&#8594; <a href="#T-protocol-invalid">handling of invalid commands</a>.
</p>
</li>
</ul></div>
</li>
<li>
<p>
<code>V</code> &#8594; V protocol:
</p>
<div class="ulist"><ul>
<li>
<p>
&#8594; <a href="#V-protocol-queries">inquiry commands</a>;
</p>
</li>
<li>
<p>
&#8594; <a href="#V-protocol-invalid">handling of invalid commands</a>.
</p>
</li>
</ul></div>
</li>
</ul></div>
</div></div>
</td>
</tr>
</table></div>
<div class="sect2">
<h3 id="P-protocol-queries">P protocol</h3>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<strong><code>QS</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Query UPS for current status and data.
</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Reply</div>
<div class="content">
<pre><code>#AB C DE F G HI JKL M N O&lt;cr&gt;</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../images/note.png" alt="Note" />
</td>
<td class="content">One space (Hex: <code>0x20</code>) is added between each field for data separation, but no space between multi-byte data.</td>
</tr></table>
</div>
<div class="paragraph"><p>Where:</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<code>#</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Start byte
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>AB C</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
MCU-detected input voltage (high, <code>A</code>, and low, <code>B</code>, bytes, V rms) and input voltage ratio (<code>C</code>):
</p>
<div class="ulist"><ul>
<li>
<p>
Input voltage (V) is obtained with the formula: <code>AB * C / 51 / 256</code>.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>DE F</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
MCU-detected output voltage (high, <code>D</code>, and low, <code>E</code>, bytes, V rms) and output voltage ratio (<code>F</code>):
</p>
<div class="ulist"><ul>
<li>
<p>
Output voltage (V) is obtained with the formula: <code>DE * F / 51 / 256</code>.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>G</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Output load level (%):
</p>
<div class="ulist"><ul>
<li>
<p>
<code>G</code> is a percentage of rated load capability, not an absolute value.
</p>
</li>
<li>
<p>
If there is no output, the value must be forced to 0 %.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>HI JKL</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Output frequency time count (high, <code>H</code> and low, <code>I</code>, bytes, Hz) and output frequency ratio (high, <code>J</code>, medium, <code>K</code>, and low, <code>L</code>, bytes)
</p>
<div class="ulist"><ul>
<li>
<p>
Frequency (Hz) is obtained with the formula: <code>JKL / HI</code>.
</p>
</li>
<li>
<p>
If the frequency is higher than 99.9 Hz, the value must be forced to 99.9 Hz.
</p>
</li>
<li>
<p>
If there is no output, the value must be forced to 0.0 Hz.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>M N</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
MCU-detected battery voltage (<code>M</code>, V rms) and battery voltage ratio (<code>N</code>):
</p>
<div class="ulist"><ul>
<li>
<p>
Battery voltage (V) is obtained with the formula: <code>M * N / 510</code>.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>O</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
UPS status (8 bits):
</p>
<div class="ulist"><ul>
<li>
<p>
<code>O</code> is one byte of binary information such as <code>&lt;b7b6b5b4b3b2b1b0&gt;</code>, where <code>bn</code> is either <code>0</code> or <code>1</code>:
</p>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="left" valign="top">Bit    </th>
<th align="left" valign="top">Logic <code>1</code>                              </th>
<th align="left" valign="top">Logic <code>0</code></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">7</p></td>
<td align="left" valign="top"><p class="table">Utility fail</p></td>
<td align="left" valign="top"><p class="table">Utility OK</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">6</p></td>
<td align="left" valign="top"><p class="table">Battery low</p></td>
<td align="left" valign="top"><p class="table">Battery is not low</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">5</p></td>
<td align="left" valign="top"><p class="table">Boost or buck mode active</p></td>
<td align="left" valign="top"><p class="table">Neither boost nor buck mode active</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">4</p></td>
<td align="left" valign="top"><p class="table">UPS fault</p></td>
<td align="left" valign="top"><p class="table">No UPS fault</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">3</p></td>
<td align="left" valign="top"><p class="table">UPS type is line-interactive</p></td>
<td align="left" valign="top"><p class="table">UPS type is on-line</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">2</p></td>
<td align="left" valign="top"><p class="table">UPS self-test in progress</p></td>
<td align="left" valign="top"><p class="table">No UPS self-test in progress</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">UPS is in shutdown active status</p></td>
<td align="left" valign="top"><p class="table">UPS is not in shutdown active status</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">0</p></td>
<td align="left" valign="top"><p class="table">Beeper is active</p></td>
<td align="left" valign="top"><p class="table">Beeper is mute</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>&lt;cr&gt;</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Stop byte
</p>
</td>
</tr>
</table></div>
<div class="admonitionblock" id="P-note">
<table><tr>
<td class="icon">
<img src="../images/note.png" alt="Note" />
</td>
<td class="content">
<div class="paragraph"><p>To prevent confusion with control characters, in the following cases the original byte is changed:</p></div>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<thead>
<tr>
<th align="center" valign="middle">Original Hex  </th>
<th align="center" valign="middle">Changed to Hex</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="middle"><p class="table"><code>0x0D</code> (CR)</p></td>
<td align="center" valign="middle"><p class="table"><code>0x28 0x00</code></p></td>
</tr>
<tr>
<td align="left" valign="middle"><p class="table"><code>0x11</code> (XON)</p></td>
<td align="center" valign="middle"><p class="table"><code>0x28 0x01</code></p></td>
</tr>
<tr>
<td align="left" valign="middle"><p class="table"><code>0x13</code> (XOFF)</p></td>
<td align="center" valign="middle"><p class="table"><code>0x28 0x02</code></p></td>
</tr>
<tr>
<td align="left" valign="middle"><p class="table"><code>0x0A</code> (LF)</p></td>
<td align="center" valign="middle"><p class="table"><code>0x28 0x03</code></p></td>
</tr>
<tr>
<td align="left" valign="middle"><p class="table"><code>0x20</code> (SP)</p></td>
<td align="center" valign="middle"><p class="table"><code>0x28 0x04</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="paragraph"><p>Hence, if you find the <code>(</code> character (Hex: <code>0x28</code>) between start byte and stop byte, then you should consider also the next byte and check if they make up one of the aforementioned sequences: if so you have to use them both to get the original value.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>For example, when PC sends the command <code>QS&lt;cr&gt;</code>, the data returned by UPS (in battery mode) is as the following hexadecimal:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Reply: 23 06 00 20 68 20 70 01 20 69 20 0C 20 61 A8 20 28 02 12 D0 20 D5 20 1E 20 89 0D
       -- -- --    --    -- --    --    --    -- --    ----- -- --    --    --    -- --
Id.:   #  A  B     C     D  E     F     G     H  I       J   K  L     M     N     O  &lt;cr&gt;</code></pre>
</div></div>
<div class="paragraph"><p>And it means:</p></div>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="left" valign="top">Id.    </th>
<th align="left" valign="top">Hex value      </th>
<th align="left" valign="top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>#</code></p></td>
<td align="left" valign="top"><p class="table"><code>23</code></p></td>
<td align="left" valign="top"><p class="table">Start byte</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AB C</code></p></td>
<td align="left" valign="top"><p class="table"><code>0600 68</code></p></td>
<td align="left" valign="top"><p class="table">Input voltage and ratio for input voltage
                        &#8594; Input voltage = <code>0x0600 * 0x68 / 51 / 256</code> = 12.2 V</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DE F</code></p></td>
<td align="left" valign="top"><p class="table"><code>7001 69</code></p></td>
<td align="left" valign="top"><p class="table">Output voltage and ratio for output voltage
                        &#8594; Output voltage = <code>0x7001 * 0x69 / 51 / 256</code> = 230.6 V</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>G</code></p></td>
<td align="left" valign="top"><p class="table"><code>0C</code></p></td>
<td align="left" valign="top"><p class="table">Output load percent = 12 %</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>HI JKL</code></p></td>
<td align="left" valign="top"><p class="table"><code>61A8 280212D0</code></p></td>
<td align="left" valign="top"><p class="table">Output frequency and ratio for output frequency
                        [<code>J</code> = <code>0x2802</code> &#8594; <code>0x13</code> (<a href="#P-note">see this note</a>) &#8594; <code>JKL</code> = <code>0x1312D0</code>]
                        &#8594; Output frequency = <code>0x1312D0 / 0x61A8</code> = 50.0 Hz</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>M N</code></p></td>
<td align="left" valign="top"><p class="table"><code>D5 1E</code></p></td>
<td align="left" valign="top"><p class="table">Battery voltage and ratio for battery voltage
                        &#8594; Battery voltage = <code>0xD5 * 0x1E / 510</code> = 12.5 V</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>O</code></p></td>
<td align="left" valign="top"><p class="table"><code>89</code></p></td>
<td align="left" valign="top"><div><div class="paragraph"><p>One byte of UPS status</p></div>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="center" valign="middle">Bit    </th>
<th align="center" valign="middle">Value  </th>
<th align="left" valign="middle">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="middle"><p class="table">7</p></td>
<td align="center" valign="middle"><p class="table"><code>1</code></p></td>
<td align="left" valign="middle"><p class="table">Utility fail</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">6</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Battery is not low</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">5</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Neither boost nor buck mode active</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">4</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">No UPS fault</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">3</p></td>
<td align="center" valign="middle"><p class="table"><code>1</code></p></td>
<td align="left" valign="middle"><p class="table">UPS type is line-interactive</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">2</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">No UPS self-test in progress</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">1</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">UPS is not in shutdown active status</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">0</p></td>
<td align="center" valign="middle"><p class="table"><code>1</code></p></td>
<td align="left" valign="middle"><p class="table">Beeper is active</p></td>
</tr>
</tbody>
</table>
</div></div></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>&lt;cr&gt;</code></p></td>
<td align="left" valign="top"><p class="table"><code>0D</code></p></td>
<td align="left" valign="top"><p class="table">Stop byte</p></td>
</tr>
</tbody>
</table>
</div>
</div></div>
</td>
</tr>
</table></div>
</div>
<div class="sect2">
<h3 id="T-protocol-queries">T protocol</h3>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<strong><code>QS</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Query UPS for current status and data.
</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Reply</div>
<div class="content">
<pre><code>#AB C DE F G HI JKL M N O P&lt;cr&gt;</code></pre>
</div></div>
<div class="paragraph"><p>Where (<a href="#P-note">this note applies</a>):</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<code>#</code>..<code>O</code>, <code>&lt;cr&gt;</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Same meaning as in the reply to the <strong><code>QS</code></strong> query of <a href="#P-protocol-queries">P protocol</a>.
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>P</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
UPS ratings (8 bits):
</p>
<div class="ulist"><ul>
<li>
<p>
<code>P</code> is one byte of binary information such as <code>&lt;b7b6b5b4b3b2b1b0&gt;</code>, where <code>bn</code> is either <code>0</code> or <code>1</code>:
</p>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<thead>
<tr>
<th align="left" valign="top">Bit    </th>
<th align="left" valign="top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">7</p></td>
<td align="left" valign="top"><div><div class="paragraph"><p>Nominal output frequency (Hz):</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>1</code> &#8594; 60 Hz
</p>
</li>
<li>
<p>
<code>0</code> &#8594; 50 Hz
</p>
</li>
</ul></div></div></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">6:5</p></td>
<td align="left" valign="top"><div><div class="paragraph"><p>Nominal battery voltage (V):</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>00</code> &#8594; 12 V
</p>
</li>
<li>
<p>
<code>01</code> &#8594; 24 V
</p>
</li>
<li>
<p>
<code>10</code> &#8594; 36 V
</p>
</li>
<li>
<p>
<code>11</code> &#8594; 48 V
</p>
</li>
</ul></div></div></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">4</p></td>
<td align="left" valign="top"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">3</p></td>
<td align="left" valign="top"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">2:1:0</p></td>
<td align="left" valign="top"><div><div class="paragraph"><p>Nominal output voltage (V):</p></div>
<div class="ulist"><ul>
<li>
<p>
<code>000</code> &#8594; 110 V
</p>
</li>
<li>
<p>
<code>001</code> &#8594; 120 V
</p>
</li>
<li>
<p>
<code>010</code> &#8594; 220 V
</p>
</li>
<li>
<p>
<code>011</code> &#8594; 230 V
</p>
</li>
<li>
<p>
<code>100</code> &#8594; 240 V
</p>
</li>
</ul></div></div></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul></div>
</td>
</tr>
</table></div>
<div class="paragraph"><p>For example, when PC sends the command <code>QS&lt;cr&gt;</code>, the data returned by UPS (in battery mode) is as the following hexadecimal:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>Reply: 23 01 02 20 65 20 73 01 20 65 20 00 20 60 00 20 12 C0 00 20 CC 20 3C 20 89 20 23 0D
       -- -- --    --    -- --    --    --    -- --    -- -- --    --    --    --    -- --
Id.:   #  A  B     C     D  E     F     G     H  I     J  K  L     M     N     O     P  &lt;cr&gt;</code></pre>
</div></div>
<div class="paragraph"><p>And it means:</p></div>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="left" valign="top">Id.    </th>
<th align="left" valign="top">Hex value      </th>
<th align="left" valign="top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table"><code>#</code></p></td>
<td align="left" valign="top"><p class="table"><code>23</code></p></td>
<td align="left" valign="top"><p class="table">Start byte</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>AB C</code></p></td>
<td align="left" valign="top"><p class="table"><code>0102 65</code></p></td>
<td align="left" valign="top"><p class="table">Input voltage and ratio for input voltage
                        &#8594; Input voltage = <code>0x0102 * 0x65 / 51 / 256</code> = 1.99 ~ 2.0 V</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>DE F</code></p></td>
<td align="left" valign="top"><p class="table"><code>7301 65</code></p></td>
<td align="left" valign="top"><p class="table">Output voltage and ratio for output voltage
                        &#8594; Output voltage = <code>0x7301 * 0x65 / 51 / 256</code> = 227.8 V</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>G</code></p></td>
<td align="left" valign="top"><p class="table"><code>00</code></p></td>
<td align="left" valign="top"><p class="table">Output load percent = 0 %</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>HI JKL</code></p></td>
<td align="left" valign="top"><p class="table"><code>6000 12C000</code></p></td>
<td align="left" valign="top"><p class="table">Output frequency and ratio for output frequency
                        &#8594; Output frequency = <code>0x12C000 / 0x6000</code> = 50.0 Hz</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>M N</code></p></td>
<td align="left" valign="top"><p class="table"><code>CC 3C</code></p></td>
<td align="left" valign="top"><p class="table">Battery voltage and ratio for battery voltage
                        &#8594; Battery voltage = <code>0xCC * 0x3C / 510</code> = 24.0 V</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>O</code></p></td>
<td align="left" valign="top"><p class="table"><code>89</code></p></td>
<td align="left" valign="top"><div><div class="paragraph"><p>One byte of UPS status</p></div>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="center" valign="middle">Bit    </th>
<th align="center" valign="middle">Value  </th>
<th align="left" valign="middle">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="middle"><p class="table">7</p></td>
<td align="center" valign="middle"><p class="table"><code>1</code></p></td>
<td align="left" valign="middle"><p class="table">Utility fail</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">6</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Battery is not low</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">5</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Neither boost nor buck mode active</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">4</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">No UPS fault</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">3</p></td>
<td align="center" valign="middle"><p class="table"><code>1</code></p></td>
<td align="left" valign="middle"><p class="table">UPS type is line-interactive</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">2</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">No UPS self-test in progress</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">1</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">UPS is not in shutdown active status</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">0</p></td>
<td align="center" valign="middle"><p class="table"><code>1</code></p></td>
<td align="left" valign="middle"><p class="table">Beeper is active</p></td>
</tr>
</tbody>
</table>
</div></div></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>P</code></p></td>
<td align="left" valign="top"><p class="table"><code>23</code></p></td>
<td align="left" valign="top"><div><div class="paragraph"><p>One byte of UPS ratings</p></div>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="center" valign="middle">Bit    </th>
<th align="center" valign="middle">Value  </th>
<th align="left" valign="middle">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="middle"><p class="table">7</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Nominal output frequency: 50 Hz</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">6:5</p></td>
<td align="center" valign="middle"><p class="table"><code>01</code></p></td>
<td align="left" valign="middle"><p class="table">Nominal battery voltage: 24 V</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">4</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">3</p></td>
<td align="center" valign="middle"><p class="table"><code>0</code></p></td>
<td align="left" valign="middle"><p class="table">Reserved</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">2:1:0</p></td>
<td align="center" valign="middle"><p class="table"><code>011</code></p></td>
<td align="left" valign="middle"><p class="table">Nominal output voltage: 230 V</p></td>
</tr>
</tbody>
</table>
</div></div></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table"><code>&lt;cr&gt;</code></p></td>
<td align="left" valign="top"><p class="table"><code>0D</code></p></td>
<td align="left" valign="top"><p class="table">Stop byte</p></td>
</tr>
</tbody>
</table>
</div>
</div></div>
</td>
</tr>
</table></div>
</div>
<div class="sect2">
<h3 id="V-protocol-queries">V protocol</h3>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<strong><code>QS</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Query UPS for current status and data.
</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Reply</div>
<div class="content">
<pre><code>(MMM.M NNN.N PPP.P QQQ RR.R SS.S TT.T U&lt;cr&gt;</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../images/note.png" alt="Note" />
</td>
<td class="content">One space (Hex: <code>0x20</code>) is added between each field for data separation.</td>
</tr></table>
</div>
<div class="paragraph"><p>Where:</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<code>(</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Start byte
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>MMM.M</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Input voltage (V rms)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>M</code> is an integer number ranging from <code>0</code> to <code>9</code>.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>NNN.N</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Input fault voltage (V rms)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>N</code> is an integer number ranging from <code>0</code> to <code>9</code>.
</p>
</li>
<li>
<p>
Its purpose is to identify a short duration voltage glitch which causes off-line UPS to go to inverter mode. If this occurs, the input voltage will appear normal at query prior to glitch and will still appear normal at next query.
</p>
</li>
<li>
<p>
The input fault voltage will hold glitch voltage till next query: after query, the input fault voltage will be the same as input voltage until next glitch occurs.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>PPP.P</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Output voltage (V rms)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>P</code> is an integer number ranging form <code>0</code> to <code>9</code>.
</p>
</li>
<li>
<p>
If there is no output, the value must be forced to <code>000.0</code> V.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>QQQ</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Output load level (%)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>Q</code> is an integer number ranging form <code>0</code> to <code>9</code>.
</p>
</li>
<li>
<p>
<code>QQQ</code> is a percentage of rated load capability, not an absolute value.
</p>
</li>
<li>
<p>
If there is no output, the value must be forced to <code>000</code> V.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>RR.R</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Output frequency (Hz)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>R</code> is an integer number ranging from <code>0</code> to <code>9</code>.
</p>
</li>
<li>
<p>
If the output frequency is higher than 99.9 Hz, the value must be forced to <code>99.9</code> Hz.
</p>
</li>
<li>
<p>
If there is no output, the value must be forced to <code>00.0</code> Hz.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SS.S</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Battery voltage (V rms)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>S</code> is an integer number ranging from <code>0</code> to <code>9</code>.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>TT.T</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Internal temperature (°C)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>T</code> is an integer number ranging form <code>0</code> to <code>9</code>.
</p>
</li>
<li>
<p>
If the value can&#8217;t be obtained, the field must be filled with <code>25.0</code> °C.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>U</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
UPS status (8 bits)
</p>
<div class="ulist"><ul>
<li>
<p>
<code>U</code> is one byte of binary information such as <code>&lt;b7b6b5b4b3b2b1b0&gt;</code>, where <code>bn</code> is either the ASCII character <code>0</code> or <code>1</code>:
</p>
<div class="tableblock">
<table rules="rows"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<thead>
<tr>
<th align="left" valign="top">Bit    </th>
<th align="left" valign="top">Logic <code>1</code>                              </th>
<th align="left" valign="top">Logic <code>0</code></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p class="table">7</p></td>
<td align="left" valign="top"><p class="table">Utility fail</p></td>
<td align="left" valign="top"><p class="table">Utility OK</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">6</p></td>
<td align="left" valign="top"><p class="table">Battery low</p></td>
<td align="left" valign="top"><p class="table">Battery is not low</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">5</p></td>
<td align="left" valign="top"><p class="table">Boost or buck mode active</p></td>
<td align="left" valign="top"><p class="table">Neither boost nor buck mode active</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">4</p></td>
<td align="left" valign="top"><p class="table">UPS fault</p></td>
<td align="left" valign="top"><p class="table">No UPS fault</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">3</p></td>
<td align="left" valign="top"><p class="table">UPS type is line-interactive</p></td>
<td align="left" valign="top"><p class="table">UPS type is on-line</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">2</p></td>
<td align="left" valign="top"><p class="table">UPS self-test in progress</p></td>
<td align="left" valign="top"><p class="table">No UPS self-test in progress</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">1</p></td>
<td align="left" valign="top"><p class="table">UPS is in shutdown active status</p></td>
<td align="left" valign="top"><p class="table">UPS is not in shutdown active status</p></td>
</tr>
<tr>
<td align="left" valign="top"><p class="table">0</p></td>
<td align="left" valign="top"><p class="table">Beeper is active</p></td>
<td align="left" valign="top"><p class="table">Beeper is mute</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>&lt;cr&gt;</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Stop byte
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>For example, when PC sends the command <code>QS&lt;cr&gt;</code>, the data returned by UPS is as follows:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>(208.4 140.0 208.4 034 59.9 12.8 35.0 00110000&lt;cr&gt;</code></pre>
</div></div>
<div class="paragraph"><p>And it means:</p></div>
<div class="ulist"><ul>
<li>
<p>
Input voltage is 208.4 V,
</p>
</li>
<li>
<p>
Input fault voltage is 140.0 V,
</p>
</li>
<li>
<p>
Output voltage is 208.4 V,
</p>
</li>
<li>
<p>
Output load level is 34 %.
</p>
</li>
<li>
<p>
Output frequency is 59.9 Hz,
</p>
</li>
<li>
<p>
Battery voltage is 12.8 V,
</p>
</li>
<li>
<p>
Temperature is 35.0 °C.
</p>
</li>
<li>
<p>
UPS type is on-line, UPS failed, AVR active and shutdown is not active.
</p>
</li>
</ul></div>
</div></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<strong><code>F</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Query UPS for ratings.
</p>
<div class="openblock">
<div class="content">
<div class="listingblock">
<div class="title">Reply</div>
<div class="content">
<pre><code>#MMM.M QQQ SS.SS RR.R&lt;cr&gt;</code></pre>
</div></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="../images/note.png" alt="Note" />
</td>
<td class="content">There should be a space character (Hex: <code>0x20</code>) between every field for data separation.</td>
</tr></table>
</div>
<div class="paragraph"><p>The UPS&#8217;s response contains the following information fields:</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<code>MMM.M</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Nominal output voltage (V).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>QQQ</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Nominal output current (A).
</p>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>SS.SS</code> or <code>SSS.S</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Nominal battery voltage (V):
</p>
<div class="ulist"><ul>
<li>
<p>
<code>SS.SS</code> when less than 99.99 V;
</p>
</li>
<li>
<p>
<code>SSS.S</code> for 99.99 V upwards.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<code>RR.R</code>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Nominal output frequency (Hz).
</p>
</td>
</tr>
</table></div>
<div class="paragraph"><p>For example, when PC sends the command <code>F&lt;cr&gt;</code>, the data returned by UPS is as follows:</p></div>
<div class="listingblock">
<div class="content">
<pre><code>#220.0 003 12.00 50.0&lt;cr&gt;</code></pre>
</div></div>
<div class="paragraph"><p>And it means:</p></div>
<div class="ulist"><ul>
<li>
<p>
Nominal output voltage is 220.0 V,
</p>
</li>
<li>
<p>
Nominal output current is 3 A,
</p>
</li>
<li>
<p>
Nominal battery voltage is 12.0 V,
</p>
</li>
<li>
<p>
Nominal output frequency is 50.0 Hz.
</p>
</li>
</ul></div>
</div></div>
</td>
</tr>
</table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="commands">Control commands</h2>
<div class="sectionbody">
<div class="paragraph"><p>By sending control commands you can control the UPS.</p></div>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<strong><code>T</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Invoke a 10 seconds battery self-test and then return to utility.
</p>
<div class="ulist"><ul>
<li>
<p>
If battery low occurs during testing, UPS will return to utility immediately.
</p>
</li>
<li>
<p>
Only when UPS is in line mode and battery voltage is not less than 13V/pcs, the command is executed.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="SnRm"></a><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Shutdown (and restore): shut UPS output off in <strong><code>&lt;n&gt;</code></strong> minutes, wait <strong><code>&lt;m&gt;</code></strong> minutes and then turn on UPS output again.
</p>
<div class="ulist"><ul>
<li>
<p>
The UPS output will be off in <strong><code>&lt;n&gt;</code></strong> minutes, even if utility power is present.
</p>
</li>
<li>
<p>
If battery low occurs before <strong><code>&lt;n&gt;</code></strong> minutes, the output is turned off immediately.
</p>
</li>
<li>
<p>
After UPS shutdown, the controller of the UPS monitors utility power: if utility is recovered, the UPS will wait for <strong><code>&lt;m&gt;</code></strong> minutes and connect the utility to output.
</p>
</li>
<li>
<p>
When <strong><code>&lt;m&gt;</code></strong> minutes expire, if utility has not been restored, the UPS will wait until utility is restored.
</p>
</li>
<li>
<p>
If UPS is in shutdown waiting status (while <strong><code>&lt;n&gt;</code></strong> minutes elapse), the <a href="#C"><strong><code>C</code></strong> command</a> can cancel the shutdown command.
</p>
</li>
<li>
<p>
If UPS is in recovery waiting status (while <strong><code>&lt;m&gt;</code></strong> minutes elapse) <em>and</em> mains is present, the <a href="#C"><strong><code>C</code></strong> command</a> can turn on the UPS output, but UPS must be held off at least 10 seconds.
</p>
</li>
<li>
<p>
<strong><code>&lt;n&gt;</code></strong> is a number ranging from <code>.2</code>, <code>.3</code>, &#8230;, <code>01</code>, <code>02</code>, &#8230;, to <code>09</code>.
</p>
</li>
<li>
<p>
<strong><code>&lt;m&gt;</code></strong> is a number ranging from <code>0000</code> to <code>9999</code>. If it is <code>0000</code>, output won&#8217;t be turned on, and, if control power can be shut off, then it is turned off immediately.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<a id="C"></a><strong><code>C</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Cancel the <a href="#SnRm"><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong> shutdown command</a>.
</p>
<div class="ulist"><ul>
<li>
<p>
UPS only accepts this command when the <a href="#SnRm"><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong> command</a> has not been completed.
</p>
</li>
<li>
<p>
If UPS is in shutdown waiting status (while <strong><code>&lt;n&gt;</code></strong> minutes of the <a href="#SnRm"><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong> command</a> elapse), the shutdown command is cancelled.
</p>
</li>
<li>
<p>
If UPS is in recovery waiting status (while <strong><code>&lt;m&gt;</code></strong> minutes of the <a href="#SnRm"><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong> command</a> elapse) <em>and</em> mains is present, the UPS output is turned on, but UPS must be held off at least 10 seconds.
</p>
</li>
</ul></div>
</td>
</tr>
<tr>
<td class="hdlist1">
<strong><code>Q</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
Toggle the UPS beeper.
</p>
<div class="ulist"><ul>
<li>
<p>
When AC power fails, UPS will generate a warning beep to inform the manager. The manager can toggle the warning beep by sending this command.
</p>
</li>
</ul></div>
</td>
</tr>
</table></div>
<div class="sect2">
<h3 id="P-protocol-commands">P protocol</h3>
<div class="hdlist"><table>
<tr>
<td class="hdlist1">
<strong><code>CT</code></strong>
<br />
</td>
<td class="hdlist2">
<p style="margin-top: 0;">
This command, though supported by devices that implement the <a href="#protocol">P protocol</a>, does nothing.
                        As a consequence of that, when this command is sent to the UPS, the device doesn&#8217;t reply anything (since the command is supported and not invalid, the UPS doesn&#8217;t return <a href="#P-protocol-invalid"><code>N&lt;cr&gt;</code></a>).
</p>
</td>
</tr>
</table></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_known_problems">Known problems</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following issues have been reported by some people with &#8216;V protocol&#8217; devices:</p></div>
<div class="ulist"><ul>
<li>
<p>
<a href="#SnRm"><strong><code>S&lt;n&gt;R0000</code></strong> command</a> is known to work as expected (i.e. turn the load off indefinitely) only if mains is present, otherwise, as soon as mains returns the load gets powered.
</p>
</li>
<li>
<p>
After issuing a <a href="#SnRm"><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong> command</a>, the UPS won&#8217;t wait <strong><code>&lt;m&gt;</code></strong> minutes before powering on the load, provided that the following conditions are met:
</p>
<div class="openblock">
<div class="content">
<div class="ulist"><ul>
<li>
<p>
if the load has been previously (no matter how long before) powered off through <a href="#SnRm"><strong><code>S&lt;n&gt;R0000</code></strong> command</a> <em>and</em> powered on through <a href="#C"><strong><code>C</code></strong> command</a> <em>and</em>
</p>
</li>
<li>
<p>
if AC wasn&#8217;t cut after issuing the <a href="#SnRm"><strong><code>S&lt;n&gt;R0000</code></strong> command</a> (i.e. the UPS didn&#8217;t turn itself off) <em>and</em>
</p>
</li>
<li>
<p>
if there&#8217;s a power outage after issuing the <a href="#SnRm"><strong><code>S&lt;n&gt;R&lt;m&gt;</code></strong> command</a>.
</p>
</li>
</ul></div>
<div class="paragraph"><p>In this case, as soon as mains returns the load gets powered.</p></div>
</div></div>
</li>
</ul></div>
</div>
</div>
<div class="sect1">
<h2 id="_revision_history">Revision history</h2>
<div class="sectionbody">
<div class="tableblock">
<table rules="rows"
style="margin-left:auto; margin-right:auto;"
frame="hsides"
cellspacing="0" cellpadding="4">
<col />
<col />
<col />
<col />
<thead>
<tr>
<th align="center" valign="middle">Rev.   </th>
<th align="center" valign="middle">Date           </th>
<th align="left" valign="middle">Description                                                            </th>
<th align="left" valign="middle">Author</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="middle"><p class="table">1.0</p></td>
<td align="center" valign="middle"><p class="table">01/2014</p></td>
<td align="left" valign="middle"><p class="table">Initial release</p></td>
<td align="left" valign="middle"><p class="table">Daniele Pezzini</p></td>
</tr>
<tr>
<td align="center" valign="middle"><p class="table">2.0</p></td>
<td align="center" valign="middle"><p class="table">11/2015</p></td>
<td align="left" valign="middle"><p class="table">Update the document adding information provided by Voltronic Power</p></td>
<td align="left" valign="middle"><p class="table">Daniele Pezzini</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2023-09-12 18:13:24 UTC
</div>
<div id="footer-badges">
<a href="https://github.com/networkupstools/nut">
  <img style="border:0;height:20"
    src="https://img.shields.io/github/checks-status/networkupstools/nut/master"
    alt="Latest GitHub checks status: master branch"/>
</a>
<!--
<a href="https://travis-ci.org/github/networkupstools/nut">
  <img style="border:0;height:20"
    src="https://api.travis-ci.org/networkupstools/nut.svg?branch=master"
    alt="Latest Travis CI build status: master branch"/>
</a>
-->
<a href="https://ci.networkupstools.org/job/nut/job/nut/job/master/">
  <img style="border:0;height:20"
    src="https://ci.networkupstools.org/buildStatus/icon?job=nut%2Fnut%2Fmaster"
    alt="Latest NUT CI build status: master branch"/>
</a>
<!-- MacOS, maybe later Windows builds: -->
<a href="https://app.circleci.com/pipelines/github/networkupstools">
  <img style="border:0;height:20"
    src="https://circleci.com/gh/networkupstools/nut/tree/master.svg?style=svg"
    alt="Latest Circle CI build status: master branch"/>
</a>
<!-- Windows, maybe later MacOS builds: -->
<a href="https://ci.appveyor.com/project/nut-travis/nut/build/artifacts">
  <img style="border:0;height:20"
    src="https://ci.appveyor.com/api/projects/status/vrhkatid9hr7lq7r/branch/master?svg=true&failingText=Windows-FAIL&passingText=Windows-OK&pendingText-Windows-PENDING"
    alt="Latest AppVeyor build status (NUT for Windows iterations)"/>
</a>
<!--
<a href="https://ci.networkupstools.org/job/nut/job/nut/job/fightwarn/">
  <img style="border:0;height:20"
    src="https://ci.networkupstools.org/buildStatus/icon?job=nut%2Fnut%2Ffightwarn&subject=Fightwarn%20Branch"
    alt="Latest NUT CI build status: fightwarn branch"/>
</a>
-->
<!--
<a href="https://github.com/networkupstools/nut/releases">
  <img style="border:0;height:20"
    src="https://img.shields.io/github/v/release/networkupstools/nut"
    alt="Latest GitHub drafted NUT source release"/>
</a>
-->
<a href="https://github.com/networkupstools/nut/releases">
  <img style="border:0;height:20"
    src="https://img.shields.io/github/v/tag/networkupstools/nut?sort=semver"
    alt="Latest Git-tagged NUT source release"/>
</a>
<!-- Maintainer note: for the counter below to work, a git tag
     is not sufficient -- a release must be drafted and published
     at https://github.com/networkupstools/nut/releases
     Counter URL may also be .../latest/BRANCHNAME -->
<a href="https://github.com/networkupstools/nut">
  <img style="border:0;height:20"
    src="https://img.shields.io/github/commits-since/networkupstools/nut/latest.svg"
    alt="Commits on master branch since latest release on GitHub"/>
</a>
<a href="http://www.methods.co.nz/asciidoc/">
  <img style="border:0;width:88px;height:31px"
    src="../images/asciidoc.png"
    alt="Powered by AsciiDoc"/>
</a>
<a href="https://validator.w3.org/check?uri=referer">
  <img style="border:0;width:88px;height:31px"
    src="https://www.w3.org/Icons/valid-xhtml11-blue"
    alt="Valid XHTML 1.1"/>
</a>
<a href="https://jigsaw.w3.org/css-validator/check?uri=referer">
  <img style="border:0;width:88px;height:31px"
    src="https://jigsaw.w3.org/css-validator/images/vcss-blue"
    alt="Valid CSS!"/>
</a>
<a href="https://www.gandi.net/">
  <img style="border:0;height:38px;"
       src="../images/gandi-ar21.svg"
       alt="DNS, redirection and related services Hoster"/>
</a>
<a href="https://fosshost.org/">
  <img style="border:0;width:112px;height:38px;"
       src="../images/ci/fosshost.org_Host_Light_38px.png"
       alt="Dedicated Hosting for NUT CI"/>
</a>
</div>
</div>
</div>
</div>
<!-- Google Analytics integration -->
<script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-9664272-1']);
        _gaq.push(['_trackPageview']);

        (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

</script>
</body>
</html>
